{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { Injectable, PLATFORM_ID, Inject, EventEmitter, Directive, Input, Output, Component, ViewEncapsulation, ViewChild, HostListener, NgModule } from '@angular/core';\nimport * as i10 from '@angular/common';\nimport { isPlatformBrowser, CommonModule } from '@angular/common';\nimport { ReplaySubject, of, Observable, Subject } from 'rxjs';\nimport * as i3 from '@angular/router';\nimport { RouterModule } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nconst _c0 = function (a0, a1, a2) {\n  return {\n    \"background-color\": a0,\n    \"color\": a1,\n    \"border-color\": a2\n  };\n};\n\nconst _c1 = [\"*\"];\nconst _c2 = [\"stepHolder\"];\nconst _c3 = [\"stepContainer\"];\n\nfunction JoyrideStepComponent_joyride_arrow_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"joyride-arrow\", 17);\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"top\", ctx_r1.arrowTopPosition, \"px\")(\"left\", ctx_r1.arrowLeftPosition, \"px\");\n    i0.ɵɵproperty(\"position\", ctx_r1.arrowPosition);\n  }\n}\n\nfunction JoyrideStepComponent_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction JoyrideStepComponent_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0);\n    i0.ɵɵpipe(1, \"async\");\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(1, 1, ctx_r5.text), \" \");\n  }\n}\n\nfunction JoyrideStepComponent_div_15_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction JoyrideStepComponent_div_15_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r13 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r13.counter);\n  }\n}\n\nfunction JoyrideStepComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, JoyrideStepComponent_div_15_ng_container_1_Template, 1, 0, \"ng-container\", 9);\n    i0.ɵɵtemplate(2, JoyrideStepComponent_div_15_ng_template_2_Template, 2, 1, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r12 = i0.ɵɵreference(3);\n\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", ctx_r6.customCounter ? ctx_r6.customCounter : _r12)(\"ngTemplateOutletContext\", ctx_r6.counterData);\n  }\n}\n\nfunction JoyrideStepComponent_div_17_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction JoyrideStepComponent_div_17_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"joyride-button\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r16 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"color\", ctx_r16.themeColor);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 2, ctx_r16.prevText));\n  }\n}\n\nfunction JoyrideStepComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵlistener(\"click\", function JoyrideStepComponent_div_17_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.prev();\n    });\n    i0.ɵɵtemplate(1, JoyrideStepComponent_div_17_ng_container_1_Template, 1, 0, \"ng-container\", 22);\n    i0.ɵɵtemplate(2, JoyrideStepComponent_div_17_ng_template_2_Template, 3, 4, \"ng-template\", null, 23, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r15 = i0.ɵɵreference(3);\n\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", ctx_r7.customPrevButton ? ctx_r7.customPrevButton : _r15);\n  }\n}\n\nfunction JoyrideStepComponent_div_18_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction JoyrideStepComponent_div_18_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"joyride-button\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r21 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"color\", ctx_r21.themeColor);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 2, ctx_r21.nextText));\n  }\n}\n\nfunction JoyrideStepComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵlistener(\"click\", function JoyrideStepComponent_div_18_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return ctx_r22.next();\n    });\n    i0.ɵɵtemplate(1, JoyrideStepComponent_div_18_ng_container_1_Template, 1, 0, \"ng-container\", 22);\n    i0.ɵɵtemplate(2, JoyrideStepComponent_div_18_ng_template_2_Template, 3, 4, \"ng-template\", null, 26, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r20 = i0.ɵɵreference(3);\n\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", ctx_r8.customNextButton ? ctx_r8.customNextButton : _r20);\n  }\n}\n\nfunction JoyrideStepComponent_ng_template_19_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction JoyrideStepComponent_ng_template_19_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"joyride-button\", 30);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r26 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"color\", ctx_r26.themeColor);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 2, ctx_r26.doneText));\n  }\n}\n\nfunction JoyrideStepComponent_ng_template_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function JoyrideStepComponent_ng_template_19_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return ctx_r27.close();\n    });\n    i0.ɵɵtemplate(1, JoyrideStepComponent_ng_template_19_ng_container_1_Template, 1, 0, \"ng-container\", 22);\n    i0.ɵɵtemplate(2, JoyrideStepComponent_ng_template_19_ng_template_2_Template, 3, 4, \"ng-template\", null, 29, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r25 = i0.ɵɵreference(3);\n\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", ctx_r10.customDoneButton ? ctx_r10.customDoneButton : _r25);\n  }\n}\n\nclass JoyrideStep {\n  constructor() {\n    this.title = new ReplaySubject();\n    this.text = new ReplaySubject();\n  }\n\n}\n\nclass JoyrideError extends Error {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, JoyrideError.prototype);\n  }\n\n}\n\nclass JoyrideStepDoesNotExist extends Error {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, JoyrideStepDoesNotExist.prototype);\n  }\n\n}\n\nclass JoyrideStepOutOfRange extends Error {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, JoyrideStepOutOfRange.prototype);\n  }\n\n}\n\nconst DEFAULT_THEME_COLOR = '#3b5560';\nconst STEP_DEFAULT_POSITION = 'bottom';\nconst DEFAULT_TIMEOUT_BETWEEN_STEPS = 1;\n\nclass ObservableCustomTexts {}\n\nconst DEFAULT_TEXTS = {\n  prev: of('prev'),\n  next: of('next'),\n  done: of('done'),\n  close: of(null)\n};\n\nclass JoyrideOptionsService {\n  constructor() {\n    this.themeColor = DEFAULT_THEME_COLOR;\n    this.stepDefaultPosition = STEP_DEFAULT_POSITION;\n    this.logsEnabled = false;\n    this.showCounter = true;\n    this.showPrevButton = true;\n    this.stepsOrder = [];\n  }\n\n  setOptions(options) {\n    this.stepsOrder = options.steps;\n    this.stepDefaultPosition = options.stepDefaultPosition ? options.stepDefaultPosition : this.stepDefaultPosition;\n    this.logsEnabled = typeof options.logsEnabled !== 'undefined' ? options.logsEnabled : this.logsEnabled;\n    this.showCounter = typeof options.showCounter !== 'undefined' ? options.showCounter : this.showCounter;\n    this.showPrevButton = typeof options.showPrevButton !== 'undefined' ? options.showPrevButton : this.showPrevButton;\n    this.themeColor = options.themeColor ? options.themeColor : this.themeColor;\n    this.firstStep = options.startWith;\n    this.waitingTime = typeof options.waitingTime !== 'undefined' ? options.waitingTime : DEFAULT_TIMEOUT_BETWEEN_STEPS;\n    typeof options.customTexts !== 'undefined' ? this.setCustomText(options.customTexts) : this.setCustomText(DEFAULT_TEXTS);\n  }\n\n  getBackdropColor() {\n    return this.hexToRgb(this.themeColor);\n  }\n\n  getThemeColor() {\n    return this.themeColor;\n  }\n\n  getStepDefaultPosition() {\n    return this.stepDefaultPosition;\n  }\n\n  getStepsOrder() {\n    return this.stepsOrder;\n  }\n\n  getFirstStep() {\n    return this.firstStep;\n  }\n\n  getWaitingTime() {\n    return this.waitingTime;\n  }\n\n  areLogsEnabled() {\n    return this.logsEnabled;\n  }\n\n  isCounterVisible() {\n    return this.showCounter;\n  }\n\n  isPrevButtonVisible() {\n    return this.showPrevButton;\n  }\n\n  getCustomTexts() {\n    return this.customTexts;\n  }\n\n  setCustomText(texts) {\n    let prev;\n    let next;\n    let done;\n    let close;\n    prev = texts.prev ? texts.prev : DEFAULT_TEXTS.prev;\n    next = texts.next ? texts.next : DEFAULT_TEXTS.next;\n    done = texts.done ? texts.done : DEFAULT_TEXTS.done;\n    close = texts.close ? texts.close : DEFAULT_TEXTS.close;\n    this.customTexts = {\n      prev: this.toObservable(prev),\n      next: this.toObservable(next),\n      done: this.toObservable(done),\n      close: this.toObservable(close)\n    };\n  }\n\n  toObservable(value) {\n    return value instanceof Observable ? value : of(value);\n  }\n\n  hexToRgb(hex) {\n    const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    hex = hex.replace(shorthandRegex, (m, r, g, b) => {\n      return r + r + g + g + b + b;\n    });\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : null;\n  }\n\n}\n\nJoyrideOptionsService.ɵfac = function JoyrideOptionsService_Factory(t) {\n  return new (t || JoyrideOptionsService)();\n};\n\nJoyrideOptionsService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: JoyrideOptionsService,\n  factory: JoyrideOptionsService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideOptionsService, [{\n    type: Injectable\n  }], null, null);\n})();\n\nconst JOYRIDE = 'ngx-joyride:::';\n\nclass LoggerService {\n  constructor(optionService) {\n    this.optionService = optionService;\n  }\n\n  debug(message, data = \"\") {\n    if (this.optionService.areLogsEnabled()) {\n      console.debug(JOYRIDE + message, data);\n    }\n  }\n\n  info(message, data = \"\") {\n    if (this.optionService.areLogsEnabled()) {\n      console.info(JOYRIDE + message, data);\n    }\n  }\n\n  warn(message, data = \"\") {\n    if (this.optionService.areLogsEnabled()) {\n      console.warn(JOYRIDE + message, data);\n    }\n  }\n\n  error(message, data = \"\") {\n    if (this.optionService.areLogsEnabled()) {\n      console.error(JOYRIDE + message, data);\n    }\n  }\n\n}\n\nLoggerService.ɵfac = function LoggerService_Factory(t) {\n  return new (t || LoggerService)(i0.ɵɵinject(JoyrideOptionsService));\n};\n\nLoggerService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: LoggerService,\n  factory: LoggerService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LoggerService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: JoyrideOptionsService\n    }];\n  }, null);\n})();\n\nconst ROUTE_SEPARATOR = '@';\n\nclass Step {}\n\nvar StepActionType;\n\n(function (StepActionType) {\n  StepActionType[\"NEXT\"] = \"NEXT\";\n  StepActionType[\"PREV\"] = \"PREV\";\n})(StepActionType || (StepActionType = {}));\n\nclass JoyrideStepsContainerService {\n  constructor(stepOptions, logger) {\n    this.stepOptions = stepOptions;\n    this.logger = logger;\n    this.tempSteps = [];\n    this.currentStepIndex = -2;\n    this.stepHasBeenModified = new Subject();\n  }\n\n  getFirstStepIndex() {\n    const firstStep = this.stepOptions.getFirstStep();\n    const stepIds = this.stepOptions.getStepsOrder();\n    let index = stepIds.indexOf(firstStep);\n\n    if (index < 0) {\n      index = 0;\n      if (firstStep !== undefined) this.logger.warn(`The step ${firstStep} does not exist. Check in your step list if it's present.`);\n    }\n\n    return index;\n  }\n\n  init() {\n    this.logger.info('Initializing the steps array.');\n    this.steps = [];\n    this.currentStepIndex = this.getFirstStepIndex() - 1;\n    let stepIds = this.stepOptions.getStepsOrder();\n    stepIds.forEach(stepId => this.steps.push({\n      id: stepId,\n      step: null\n    }));\n  }\n\n  addStep(stepToAdd) {\n    let stepExist = this.tempSteps.filter(step => step.name === stepToAdd.name).length > 0;\n\n    if (!stepExist) {\n      this.logger.info(`Adding step ${stepToAdd.name} to the steps list.`);\n      this.tempSteps.push(stepToAdd);\n    } else {\n      let stepIndexToReplace = this.tempSteps.findIndex(step => step.name === stepToAdd.name);\n      this.tempSteps[stepIndexToReplace] = stepToAdd;\n    }\n  }\n\n  get(action) {\n    if (action === StepActionType.NEXT) this.currentStepIndex++;else this.currentStepIndex--;\n    if (this.currentStepIndex < 0 || this.currentStepIndex >= this.steps.length) throw new JoyrideStepOutOfRange('The first or last step of the tour cannot be found!');\n    const stepName = this.getStepName(this.steps[this.currentStepIndex].id);\n    const index = this.tempSteps.findIndex(step => step.name === stepName);\n    let stepFound = this.tempSteps[index];\n    this.steps[this.currentStepIndex].step = stepFound;\n\n    if (stepFound == null) {\n      this.logger.warn(`Step ${this.steps[this.currentStepIndex].id} not found in the DOM. Check if it's hidden by *ngIf directive.`);\n    }\n\n    return stepFound;\n  }\n\n  getStepRoute(action) {\n    let stepID;\n\n    if (action === StepActionType.NEXT) {\n      stepID = this.steps[this.currentStepIndex + 1] ? this.steps[this.currentStepIndex + 1].id : null;\n    } else {\n      stepID = this.steps[this.currentStepIndex - 1] ? this.steps[this.currentStepIndex - 1].id : null;\n    }\n\n    let stepRoute = stepID && stepID.includes(ROUTE_SEPARATOR) ? stepID.split(ROUTE_SEPARATOR)[1] : '';\n    return stepRoute;\n  }\n\n  updatePosition(stepName, position) {\n    let index = this.getStepIndex(stepName);\n\n    if (this.steps[index].step) {\n      this.steps[index].step.position = position;\n      this.stepHasBeenModified.next(this.steps[index].step);\n    } else {\n      this.logger.warn(`Trying to modify the position of ${stepName} to ${position}. Step not found!Is this step located in a different route?`);\n    }\n  }\n\n  getStepNumber(stepName) {\n    return this.getStepIndex(stepName) + 1;\n  }\n\n  getStepsCount() {\n    let stepsOrder = this.stepOptions.getStepsOrder();\n    return stepsOrder.length;\n  }\n\n  getStepIndex(stepName) {\n    const index = this.steps.map(step => step.id.includes(ROUTE_SEPARATOR) ? step.id.split(ROUTE_SEPARATOR)[0] : step.id).findIndex(name => stepName === name);\n    if (index === -1) throw new JoyrideError(`The step with name: ${stepName} does not exist in the step list.`);\n    return index;\n  }\n\n  getStepName(stepID) {\n    let stepName = stepID && stepID.includes(ROUTE_SEPARATOR) ? stepID.split(ROUTE_SEPARATOR)[0] : stepID;\n    return stepName;\n  }\n\n}\n\nJoyrideStepsContainerService.ɵfac = function JoyrideStepsContainerService_Factory(t) {\n  return new (t || JoyrideStepsContainerService)(i0.ɵɵinject(JoyrideOptionsService), i0.ɵɵinject(LoggerService));\n};\n\nJoyrideStepsContainerService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: JoyrideStepsContainerService,\n  factory: JoyrideStepsContainerService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideStepsContainerService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: JoyrideOptionsService\n    }, {\n      type: LoggerService\n    }];\n  }, null);\n})();\n\nclass DomRefService {\n  constructor(platformId) {\n    this.platformId = platformId;\n    this.fakeDocument = {\n      body: {},\n      documentElement: {}\n    };\n    this.fakeWindow = {\n      document: this.fakeDocument,\n      navigator: {}\n    };\n  }\n\n  getNativeWindow() {\n    if (isPlatformBrowser(this.platformId)) return window;else return this.fakeWindow;\n  }\n\n  getNativeDocument() {\n    if (isPlatformBrowser(this.platformId)) return document;else return this.fakeDocument;\n  }\n\n}\n\nDomRefService.ɵfac = function DomRefService_Factory(t) {\n  return new (t || DomRefService)(i0.ɵɵinject(PLATFORM_ID));\n};\n\nDomRefService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: DomRefService,\n  factory: DomRefService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(DomRefService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: Object,\n      decorators: [{\n        type: Inject,\n        args: [PLATFORM_ID]\n      }]\n    }];\n  }, null);\n})();\n\nclass TemplatesService {\n  setPrevButton(template) {\n    this._prevButton = template;\n  }\n\n  getPrevButton() {\n    return this._prevButton;\n  }\n\n  setNextButton(template) {\n    this._nextButton = template;\n  }\n\n  getNextButton() {\n    return this._nextButton;\n  }\n\n  setDoneButton(template) {\n    this._doneButton = template;\n  }\n\n  getDoneButton() {\n    return this._doneButton;\n  }\n\n  setCounter(template) {\n    this._counter = template;\n  }\n\n  getCounter() {\n    return this._counter;\n  }\n\n}\n\nTemplatesService.ɵfac = function TemplatesService_Factory(t) {\n  return new (t || TemplatesService)();\n};\n\nTemplatesService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: TemplatesService,\n  factory: TemplatesService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(TemplatesService, [{\n    type: Injectable\n  }], null, null);\n})();\n\nconst NO_POSITION = 'NO_POSITION';\n\nclass JoyrideDirective {\n  constructor(joyrideStepsContainer, viewContainerRef, domService, router, templateService, platformId) {\n    this.joyrideStepsContainer = joyrideStepsContainer;\n    this.viewContainerRef = viewContainerRef;\n    this.domService = domService;\n    this.router = router;\n    this.templateService = templateService;\n    this.platformId = platformId;\n    this.stepPosition = NO_POSITION;\n    this.prev = new EventEmitter();\n    this.next = new EventEmitter();\n    this.done = new EventEmitter();\n    this.subscriptions = [];\n    this.windowRef = this.domService.getNativeWindow();\n    this.step = new JoyrideStep();\n  }\n\n  ngAfterViewInit() {\n    if (!isPlatformBrowser(this.platformId)) return;\n    if (this.prevTemplate) this.templateService.setPrevButton(this.prevTemplate);\n    if (this.nextTemplate) this.templateService.setNextButton(this.nextTemplate);\n    if (this.doneTemplate) this.templateService.setDoneButton(this.doneTemplate);\n    if (this.counterTemplate) this.templateService.setCounter(this.counterTemplate);\n    this.step.position = this.stepPosition;\n    this.step.targetViewContainer = this.viewContainerRef;\n    this.setAsyncFields(this.step);\n    this.step.stepContent = this.stepContent;\n    this.step.stepContentParams = this.stepContentParams;\n    this.step.nextClicked = this.next;\n    this.step.prevCliked = this.prev;\n    this.step.tourDone = this.done;\n    if (!this.name) throw new JoyrideError(\"All the steps should have the 'joyrideStep' property set with a custom name.\");\n    this.step.name = this.name;\n    this.step.route = this.router.url.substr(0, 1) === '/' ? this.router.url.substr(1) : this.router.url;\n    this.step.transformCssStyle = this.windowRef.getComputedStyle(this.viewContainerRef.element.nativeElement).transform;\n    this.step.isElementOrAncestorFixed = this.isElementFixed(this.viewContainerRef.element) || this.isAncestorsFixed(this.viewContainerRef.element.nativeElement.parentElement);\n    this.joyrideStepsContainer.addStep(this.step);\n  }\n\n  ngOnChanges(changes) {\n    if (changes['title'] || changes['text']) {\n      this.setAsyncFields(this.step);\n    }\n  }\n\n  isElementFixed(element) {\n    return this.windowRef.getComputedStyle(element.nativeElement).position === 'fixed';\n  }\n\n  setAsyncFields(step) {\n    if (this.title instanceof Observable) {\n      this.subscriptions.push(this.title.subscribe(title => {\n        step.title.next(title);\n      }));\n    } else {\n      step.title.next(this.title);\n    }\n\n    if (this.text instanceof Observable) {\n      this.subscriptions.push(this.text.subscribe(text => {\n        step.text.next(text);\n      }));\n    } else {\n      step.text.next(this.text);\n    }\n  }\n\n  isAncestorsFixed(nativeElement) {\n    if (!nativeElement || !nativeElement.parentElement) return false;\n    let isElementFixed = this.windowRef.getComputedStyle(nativeElement.parentElement).position === 'fixed';\n\n    if (nativeElement.nodeName === 'BODY') {\n      return isElementFixed;\n    }\n\n    if (isElementFixed) return true;else return this.isAncestorsFixed(nativeElement.parentElement);\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach(sub => {\n      sub.unsubscribe();\n    });\n  }\n\n}\n\nJoyrideDirective.ɵfac = function JoyrideDirective_Factory(t) {\n  return new (t || JoyrideDirective)(i0.ɵɵdirectiveInject(JoyrideStepsContainerService), i0.ɵɵdirectiveInject(i0.ViewContainerRef), i0.ɵɵdirectiveInject(DomRefService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(TemplatesService), i0.ɵɵdirectiveInject(PLATFORM_ID));\n};\n\nJoyrideDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n  type: JoyrideDirective,\n  selectors: [[\"joyrideStep\"], [\"\", \"joyrideStep\", \"\"]],\n  inputs: {\n    name: [\"joyrideStep\", \"name\"],\n    nextStep: \"nextStep\",\n    title: \"title\",\n    text: \"text\",\n    stepPosition: \"stepPosition\",\n    stepContent: \"stepContent\",\n    stepContentParams: \"stepContentParams\",\n    prevTemplate: \"prevTemplate\",\n    nextTemplate: \"nextTemplate\",\n    doneTemplate: \"doneTemplate\",\n    counterTemplate: \"counterTemplate\"\n  },\n  outputs: {\n    prev: \"prev\",\n    next: \"next\",\n    done: \"done\"\n  },\n  features: [i0.ɵɵNgOnChangesFeature]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideDirective, [{\n    type: Directive,\n    args: [{\n      selector: 'joyrideStep, [joyrideStep]'\n    }]\n  }], function () {\n    return [{\n      type: JoyrideStepsContainerService\n    }, {\n      type: i0.ViewContainerRef\n    }, {\n      type: DomRefService\n    }, {\n      type: i3.Router\n    }, {\n      type: TemplatesService\n    }, {\n      type: Object,\n      decorators: [{\n        type: Inject,\n        args: [PLATFORM_ID]\n      }]\n    }];\n  }, {\n    name: [{\n      type: Input,\n      args: ['joyrideStep']\n    }],\n    nextStep: [{\n      type: Input\n    }],\n    title: [{\n      type: Input\n    }],\n    text: [{\n      type: Input\n    }],\n    stepPosition: [{\n      type: Input\n    }],\n    stepContent: [{\n      type: Input\n    }],\n    stepContentParams: [{\n      type: Input\n    }],\n    prevTemplate: [{\n      type: Input\n    }],\n    nextTemplate: [{\n      type: Input\n    }],\n    doneTemplate: [{\n      type: Input\n    }],\n    counterTemplate: [{\n      type: Input\n    }],\n    prev: [{\n      type: Output\n    }],\n    next: [{\n      type: Output\n    }],\n    done: [{\n      type: Output\n    }]\n  });\n})();\n\nclass JoyrideStepInfo {}\n\nclass DocumentService {\n  constructor(DOMService, platformId) {\n    this.DOMService = DOMService;\n\n    if (!isPlatformBrowser(platformId)) {\n      return;\n    }\n\n    this.setDocumentHeight();\n    var doc = DOMService.getNativeDocument();\n\n    if (doc && !doc.elementsFromPoint) {\n      // IE 11 - Edge browsers\n      doc.elementsFromPoint = this.elementsFromPoint.bind(this);\n    }\n  }\n\n  getElementFixedTop(elementRef) {\n    return elementRef.nativeElement.getBoundingClientRect().top;\n  }\n\n  getElementFixedLeft(elementRef) {\n    return elementRef.nativeElement.getBoundingClientRect().left;\n  }\n\n  getElementAbsoluteTop(elementRef) {\n    const scrollOffsets = this.getScrollOffsets();\n    return elementRef.nativeElement.getBoundingClientRect().top + scrollOffsets.y;\n  }\n\n  getElementAbsoluteLeft(elementRef) {\n    const scrollOffsets = this.getScrollOffsets();\n    return elementRef.nativeElement.getBoundingClientRect().left + scrollOffsets.x;\n  }\n\n  setDocumentHeight() {\n    this.documentHeight = this.calculateDocumentHeight();\n  }\n\n  getDocumentHeight() {\n    return this.documentHeight;\n  }\n\n  isParentScrollable(elementRef) {\n    return this.getFirstScrollableParent(elementRef.nativeElement) !== this.DOMService.getNativeDocument().body;\n  }\n\n  isElementBeyondOthers(elementRef, isElementFixed, keywordToDiscard) {\n    const x1 = isElementFixed ? this.getElementFixedLeft(elementRef) : this.getElementAbsoluteLeft(elementRef);\n    const y1 = isElementFixed ? this.getElementFixedTop(elementRef) : this.getElementAbsoluteTop(elementRef);\n    const x2 = x1 + elementRef.nativeElement.getBoundingClientRect().width - 1;\n    const y2 = y1 + elementRef.nativeElement.getBoundingClientRect().height - 1;\n    const elements1 = this.DOMService.getNativeDocument().elementsFromPoint(x1, y1);\n    const elements2 = this.DOMService.getNativeDocument().elementsFromPoint(x2, y2);\n    if (elements1.length === 0 && elements2.length === 0) return 1;\n\n    if (this.getFirstElementWithoutKeyword(elements1, keywordToDiscard) !== elementRef.nativeElement || this.getFirstElementWithoutKeyword(elements2, keywordToDiscard) !== elementRef.nativeElement) {\n      return 2;\n    }\n\n    return 3;\n  }\n\n  scrollIntoView(elementRef, isElementFixed) {\n    const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n    const top = isElementFixed ? this.getElementFixedTop(elementRef) : this.getElementAbsoluteTop(elementRef);\n\n    if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n      if (firstScrollableParent.scrollTo) {\n        firstScrollableParent.scrollTo(0, top - 150);\n      } else {\n        // IE 11 - Edge browsers\n        firstScrollableParent.scrollTop = top - 150;\n      }\n    } else {\n      this.DOMService.getNativeWindow().scrollTo(0, top - 150);\n    }\n  }\n\n  scrollToTheTop(elementRef) {\n    const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n\n    if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n      if (firstScrollableParent.scrollTo) {\n        firstScrollableParent.scrollTo(0, 0);\n      } else {\n        // IE 11 - Edge browsers\n        firstScrollableParent.scrollTop = 0;\n      }\n    } else {\n      this.DOMService.getNativeWindow().scrollTo(0, 0);\n    }\n  }\n\n  scrollToTheBottom(elementRef) {\n    const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n\n    if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n      if (firstScrollableParent.scrollTo) {\n        firstScrollableParent.scrollTo(0, this.DOMService.getNativeDocument().body.scrollHeight);\n      } else {\n        // IE 11 - Edge browsers\n        firstScrollableParent.scrollTop = firstScrollableParent.scrollHeight - firstScrollableParent.clientHeight;\n      }\n    } else {\n      this.DOMService.getNativeWindow().scrollTo(0, this.DOMService.getNativeDocument().body.scrollHeight);\n    }\n  }\n\n  getFirstScrollableParent(node) {\n    const regex = /(auto|scroll|overlay)/;\n\n    const style = (node, prop) => this.DOMService.getNativeWindow().getComputedStyle(node, null).getPropertyValue(prop);\n\n    const scroll = node => regex.test(style(node, 'overflow') + style(node, 'overflow-y') + style(node, 'overflow-x'));\n\n    const scrollparent = node => {\n      return !node || node === this.DOMService.getNativeDocument().body ? this.DOMService.getNativeDocument().body : scroll(node) ? node : scrollparent(node.parentNode);\n    };\n\n    return scrollparent(node);\n  }\n\n  calculateDocumentHeight() {\n    const documentRef = this.DOMService.getNativeDocument();\n    return Math.max(documentRef.body.scrollHeight, documentRef.documentElement.scrollHeight, documentRef.body.offsetHeight, documentRef.documentElement.offsetHeight, documentRef.body.clientHeight, documentRef.documentElement.clientHeight);\n  }\n\n  getScrollOffsets() {\n    const winReference = this.DOMService.getNativeWindow();\n    const docReference = this.DOMService.getNativeDocument(); // This works for all browsers except IE versions 8 and before\n\n    if (winReference.pageXOffset != null) return {\n      x: winReference.pageXOffset,\n      y: winReference.pageYOffset\n    }; // For IE (or any browser) in Standards mode\n\n    if (docReference.compatMode == 'CSS1Compat') return {\n      x: docReference.documentElement.scrollLeft,\n      y: docReference.documentElement.scrollTop\n    }; // For browsers in Quirks mode\n\n    return {\n      x: docReference.body.scrollLeft,\n      y: docReference.body.scrollTop\n    };\n  }\n\n  elementsFromPoint(x, y) {\n    var parents = [];\n    var parent = void 0;\n\n    do {\n      const elem = this.DOMService.getNativeDocument().elementFromPoint(x, y);\n\n      if (elem && parent !== elem) {\n        parent = elem;\n        parents.push(parent);\n        parent.style.pointerEvents = 'none';\n      } else {\n        parent = false;\n      }\n    } while (parent);\n\n    parents.forEach(function (parent) {\n      return parent.style.pointerEvents = 'all';\n    });\n    return parents;\n  }\n\n  getFirstElementWithoutKeyword(elements, keyword) {\n    while (elements[0] && elements[0].classList.toString().includes(keyword)) {\n      elements.shift();\n    }\n\n    return elements[0];\n  }\n\n}\n\nDocumentService.ɵfac = function DocumentService_Factory(t) {\n  return new (t || DocumentService)(i0.ɵɵinject(DomRefService), i0.ɵɵinject(PLATFORM_ID));\n};\n\nDocumentService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: DocumentService,\n  factory: DocumentService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(DocumentService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: DomRefService\n    }, {\n      type: Object,\n      decorators: [{\n        type: Inject,\n        args: [PLATFORM_ID]\n      }]\n    }];\n  }, null);\n})();\n\nclass JoyrideBackdropService {\n  constructor(documentService, optionsService, rendererFactory) {\n    this.documentService = documentService;\n    this.optionsService = optionsService;\n    this.rendererFactory = rendererFactory;\n    this.lastXScroll = 0;\n    this.lastYScroll = 0;\n    this.setRenderer();\n  }\n\n  setRenderer() {\n    this.renderer = this.rendererFactory.createRenderer(null, null);\n  }\n\n  draw(step) {\n    this.elementRef = step.targetViewContainer;\n    this.targetAbsoluteTop = this.getTargetTotalTop(step);\n    this.targetAbsoluteLeft = this.getTargetTotalLeft(step);\n    this.currentBackdropContainer = this.renderer.createElement('div');\n    this.renderer.addClass(this.currentBackdropContainer, 'backdrop-container');\n    this.renderer.setStyle(this.currentBackdropContainer, 'position', 'fixed');\n    this.renderer.setStyle(this.currentBackdropContainer, 'top', '0px');\n    this.renderer.setStyle(this.currentBackdropContainer, 'left', '0px');\n    this.renderer.setStyle(this.currentBackdropContainer, 'width', '100%');\n    this.renderer.setStyle(this.currentBackdropContainer, 'height', '100%');\n    this.renderer.setStyle(this.currentBackdropContainer, 'z-index', '1000');\n    this.renderer.setAttribute(this.currentBackdropContainer, 'id', 'backdrop-' + step.name);\n    this.backdropContent = this.renderer.createElement('div');\n    this.renderer.addClass(this.backdropContent, 'backdrop-content');\n    this.renderer.setStyle(this.backdropContent, 'position', 'relative');\n    this.renderer.setStyle(this.backdropContent, 'height', '100%');\n    this.renderer.setStyle(this.backdropContent, 'display', 'flex');\n    this.renderer.setStyle(this.backdropContent, 'flex-direction', 'column');\n    this.renderer.appendChild(this.currentBackdropContainer, this.backdropContent);\n    this.backdropTop = this.renderer.createElement('div');\n    this.renderer.addClass(this.backdropTop, 'joyride-backdrop');\n    this.renderer.addClass(this.backdropTop, 'backdrop-top');\n    this.renderer.setStyle(this.backdropTop, 'width', '100%');\n    this.renderer.setStyle(this.backdropTop, 'height', this.targetAbsoluteTop - this.lastYScroll + 'px');\n    this.renderer.setStyle(this.backdropTop, 'flex-shrink', '0');\n    this.renderer.setStyle(this.backdropTop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n    this.renderer.appendChild(this.backdropContent, this.backdropTop);\n    this.backdropMiddleContainer = this.renderer.createElement('div');\n    this.renderer.addClass(this.backdropMiddleContainer, 'backdrop-middle-container');\n    this.renderer.setStyle(this.backdropMiddleContainer, 'height', this.elementRef.element.nativeElement.offsetHeight + 'px');\n    this.renderer.setStyle(this.backdropMiddleContainer, 'width', '100%');\n    this.renderer.setStyle(this.backdropMiddleContainer, 'flex-shrink', '0');\n    this.renderer.appendChild(this.backdropContent, this.backdropMiddleContainer);\n    this.backdropMiddleContent = this.renderer.createElement('div');\n    this.renderer.addClass(this.backdropMiddleContent, 'backdrop-middle-content');\n    this.renderer.setStyle(this.backdropMiddleContent, 'display', 'flex');\n    this.renderer.setStyle(this.backdropMiddleContent, 'width', '100%');\n    this.renderer.setStyle(this.backdropMiddleContent, 'height', '100%');\n    this.renderer.appendChild(this.backdropMiddleContainer, this.backdropMiddleContent);\n    this.leftBackdrop = this.renderer.createElement('div');\n    this.renderer.addClass(this.leftBackdrop, 'joyride-backdrop');\n    this.renderer.addClass(this.leftBackdrop, 'backdrop-left');\n    this.renderer.setStyle(this.leftBackdrop, 'flex-shrink', '0');\n    this.renderer.setStyle(this.leftBackdrop, 'width', this.targetAbsoluteLeft - this.lastXScroll + 'px');\n    this.renderer.setStyle(this.leftBackdrop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n    this.renderer.appendChild(this.backdropMiddleContent, this.leftBackdrop);\n    this.targetBackdrop = this.renderer.createElement('div');\n    this.renderer.addClass(this.targetBackdrop, 'backdrop-target');\n    this.renderer.setStyle(this.targetBackdrop, 'flex-shrink', '0');\n    this.renderer.setStyle(this.targetBackdrop, 'width', this.elementRef.element.nativeElement.offsetWidth + 'px');\n    this.renderer.appendChild(this.backdropMiddleContent, this.targetBackdrop);\n    this.rightBackdrop = this.renderer.createElement('div');\n    this.renderer.addClass(this.rightBackdrop, 'joyride-backdrop');\n    this.renderer.addClass(this.rightBackdrop, 'backdrop-right');\n    this.renderer.setStyle(this.rightBackdrop, 'width', '100%');\n    this.renderer.setStyle(this.rightBackdrop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n    this.renderer.appendChild(this.backdropMiddleContent, this.rightBackdrop);\n    this.backdropBottom = this.renderer.createElement('div');\n    this.renderer.addClass(this.backdropBottom, 'joyride-backdrop');\n    this.renderer.addClass(this.backdropBottom, 'backdrop-bottom');\n    this.renderer.setStyle(this.backdropBottom, 'width', '100%');\n    this.renderer.setStyle(this.backdropBottom, 'height', '100%');\n    this.renderer.setStyle(this.backdropBottom, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n    this.renderer.appendChild(this.backdropContent, this.backdropBottom);\n    this.removeLastBackdrop();\n    this.drawCurrentBackdrop();\n    this.lastBackdropContainer = this.currentBackdropContainer;\n  }\n\n  remove() {\n    this.removeLastBackdrop();\n  }\n\n  redrawTarget(step) {\n    this.targetAbsoluteLeft = this.getTargetTotalLeft(step);\n    this.targetAbsoluteTop = this.getTargetTotalTop(step);\n    this.handleVerticalScroll(step);\n    this.handleHorizontalScroll(step);\n  }\n\n  getTargetTotalTop(step) {\n    let targetVC = step.targetViewContainer;\n    return step.isElementOrAncestorFixed ? this.documentService.getElementFixedTop(targetVC.element) : this.documentService.getElementAbsoluteTop(targetVC.element);\n  }\n\n  getTargetTotalLeft(step) {\n    let targetVC = step.targetViewContainer;\n    return step.isElementOrAncestorFixed ? this.documentService.getElementFixedLeft(targetVC.element) : this.documentService.getElementAbsoluteLeft(targetVC.element);\n  }\n\n  redraw(step, scroll) {\n    if (this.lastYScroll !== scroll.scrollY) {\n      this.lastYScroll = scroll.scrollY;\n\n      if (this.elementRef) {\n        this.handleVerticalScroll(step);\n      }\n    }\n\n    if (this.lastXScroll !== scroll.scrollX) {\n      this.lastXScroll = scroll.scrollX;\n\n      if (this.elementRef) {\n        this.handleHorizontalScroll(step);\n      }\n    }\n  }\n\n  handleHorizontalScroll(step) {\n    let newBackdropLeftWidth = step.isElementOrAncestorFixed ? this.targetAbsoluteLeft : this.targetAbsoluteLeft - this.lastXScroll;\n\n    if (newBackdropLeftWidth >= 0) {\n      this.renderer.setStyle(this.leftBackdrop, 'width', newBackdropLeftWidth + 'px');\n      this.renderer.setStyle(this.targetBackdrop, 'width', this.elementRef.element.nativeElement.offsetWidth + 'px');\n    } else {\n      this.handleTargetPartialWidth(newBackdropLeftWidth);\n    }\n  }\n\n  handleTargetPartialWidth(newBackdropLeftWidth) {\n    this.renderer.setStyle(this.leftBackdrop, 'width', 0 + 'px');\n    let visibleTargetWidth = this.elementRef.element.nativeElement.offsetWidth + newBackdropLeftWidth;\n\n    if (visibleTargetWidth >= 0) {\n      this.renderer.setStyle(this.targetBackdrop, 'width', visibleTargetWidth + 'px');\n    } else {\n      this.renderer.setStyle(this.targetBackdrop, 'width', 0 + 'px');\n    }\n  }\n\n  handleVerticalScroll(step) {\n    let newBackdropTopHeight = step.isElementOrAncestorFixed ? this.targetAbsoluteTop : this.targetAbsoluteTop - this.lastYScroll;\n\n    if (newBackdropTopHeight >= 0) {\n      this.renderer.setStyle(this.backdropTop, 'height', newBackdropTopHeight + 'px');\n      this.renderer.setStyle(this.backdropMiddleContainer, 'height', this.elementRef.element.nativeElement.offsetHeight + 'px');\n    } else {\n      this.handleTargetPartialHeight(newBackdropTopHeight);\n    }\n  }\n\n  handleTargetPartialHeight(newBackdropTopHeight) {\n    this.renderer.setStyle(this.backdropTop, 'height', 0 + 'px');\n    let visibleTargetHeight = this.elementRef.element.nativeElement.offsetHeight + newBackdropTopHeight;\n\n    if (visibleTargetHeight >= 0) {\n      this.renderer.setStyle(this.backdropMiddleContainer, 'height', visibleTargetHeight + 'px');\n    } else {\n      this.renderer.setStyle(this.backdropMiddleContainer, 'height', 0 + 'px');\n    }\n  }\n\n  removeLastBackdrop() {\n    if (this.lastBackdropContainer) {\n      this.renderer.removeChild(document.body, this.lastBackdropContainer);\n      this.lastBackdropContainer = undefined;\n    }\n  }\n\n  drawCurrentBackdrop() {\n    this.renderer.appendChild(document.body, this.currentBackdropContainer);\n  }\n\n}\n\nJoyrideBackdropService.ɵfac = function JoyrideBackdropService_Factory(t) {\n  return new (t || JoyrideBackdropService)(i0.ɵɵinject(DocumentService), i0.ɵɵinject(JoyrideOptionsService), i0.ɵɵinject(i0.RendererFactory2));\n};\n\nJoyrideBackdropService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: JoyrideBackdropService,\n  factory: JoyrideBackdropService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideBackdropService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: DocumentService\n    }, {\n      type: JoyrideOptionsService\n    }, {\n      type: i0.RendererFactory2\n    }];\n  }, null);\n})();\n\nclass Scroll {}\n\nclass EventListenerService {\n  constructor(rendererFactory, DOMService) {\n    this.rendererFactory = rendererFactory;\n    this.DOMService = DOMService;\n    this.scrollEvent = new Subject();\n    this.resizeEvent = new Subject();\n    this.renderer = rendererFactory.createRenderer(null, null);\n  }\n\n  startListeningScrollEvents() {\n    this.scrollUnlisten = this.renderer.listen('document', 'scroll', evt => {\n      this.scrollEvent.next({\n        scrollX: this.DOMService.getNativeWindow().pageXOffset,\n        scrollY: this.DOMService.getNativeWindow().pageYOffset\n      });\n    });\n  }\n\n  startListeningResizeEvents() {\n    this.resizeUnlisten = this.renderer.listen('window', 'resize', evt => {\n      this.resizeEvent.next(evt);\n    });\n  }\n\n  stopListeningScrollEvents() {\n    this.scrollUnlisten();\n  }\n\n  stopListeningResizeEvents() {\n    this.resizeUnlisten();\n  }\n\n}\n\nEventListenerService.ɵfac = function EventListenerService_Factory(t) {\n  return new (t || EventListenerService)(i0.ɵɵinject(i0.RendererFactory2), i0.ɵɵinject(DomRefService));\n};\n\nEventListenerService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: EventListenerService,\n  factory: EventListenerService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(EventListenerService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i0.RendererFactory2\n    }, {\n      type: DomRefService\n    }];\n  }, null);\n})();\n\nclass JoyrideArrowComponent {\n  constructor() {\n    this.position = 'top';\n  }\n\n}\n\nJoyrideArrowComponent.ɵfac = function JoyrideArrowComponent_Factory(t) {\n  return new (t || JoyrideArrowComponent)();\n};\n\nJoyrideArrowComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: JoyrideArrowComponent,\n  selectors: [[\"joyride-arrow\"]],\n  inputs: {\n    position: \"position\"\n  },\n  decls: 1,\n  vars: 8,\n  template: function JoyrideArrowComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"div\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵclassProp(\"joyride-arrow__top\", ctx.position == \"top\")(\"joyride-arrow__bottom\", ctx.position == \"bottom\")(\"joyride-arrow__left\", ctx.position == \"left\")(\"joyride-arrow__right\", ctx.position == \"right\");\n    }\n  },\n  styles: [\".joyride-arrow__top{border-left:11px solid transparent;border-right:11px solid transparent;border-bottom:11px solid #ffffff}.joyride-arrow__bottom{border-left:11px solid transparent;border-right:11px solid transparent;border-top:11px solid #ffffff}.joyride-arrow__right{border-left:11px solid #ffffff;border-bottom:11px solid transparent;border-top:11px solid transparent}.joyride-arrow__left{border-right:11px solid #ffffff;border-top:11px solid transparent;border-bottom:11px solid transparent}\\n\"],\n  encapsulation: 2\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideArrowComponent, [{\n    type: Component,\n    args: [{\n      selector: 'joyride-arrow',\n      encapsulation: ViewEncapsulation.None,\n      template: \"<div [class.joyride-arrow__top]=\\\"position == 'top'\\\"\\n     [class.joyride-arrow__bottom]=\\\"position == 'bottom'\\\"\\n     [class.joyride-arrow__left]=\\\"position == 'left'\\\"\\n     [class.joyride-arrow__right]=\\\"position == 'right'\\\">\\n</div>\",\n      styles: [\".joyride-arrow__top{border-left:11px solid transparent;border-right:11px solid transparent;border-bottom:11px solid #ffffff}.joyride-arrow__bottom{border-left:11px solid transparent;border-right:11px solid transparent;border-top:11px solid #ffffff}.joyride-arrow__right{border-left:11px solid #ffffff;border-bottom:11px solid transparent;border-top:11px solid transparent}.joyride-arrow__left{border-right:11px solid #ffffff;border-top:11px solid transparent;border-bottom:11px solid transparent}\\n\"]\n    }]\n  }], null, {\n    position: [{\n      type: Input\n    }]\n  });\n})();\n\nclass JoyrideCloseButtonComponent {}\n\nJoyrideCloseButtonComponent.ɵfac = function JoyrideCloseButtonComponent_Factory(t) {\n  return new (t || JoyrideCloseButtonComponent)();\n};\n\nJoyrideCloseButtonComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: JoyrideCloseButtonComponent,\n  selectors: [[\"joy-close-button\"]],\n  decls: 3,\n  vars: 0,\n  consts: [[\"viewBox\", \"0 0 25 25\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"x1\", \"1\", \"y1\", \"24\", \"x2\", \"24\", \"y2\", \"1\", \"stroke\", \"black\", \"stroke-width\", \"3\"], [\"x1\", \"1\", \"y1\", \"1\", \"x2\", \"24\", \"y2\", \"24\", \"stroke\", \"black\", \"stroke-width\", \"3\"]],\n  template: function JoyrideCloseButtonComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵnamespaceSVG();\n      i0.ɵɵelementStart(0, \"svg\", 0);\n      i0.ɵɵelement(1, \"line\", 1);\n      i0.ɵɵelement(2, \"line\", 2);\n      i0.ɵɵelementEnd();\n    }\n  },\n  encapsulation: 2\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideCloseButtonComponent, [{\n    type: Component,\n    args: [{\n      selector: 'joy-close-button',\n      template: `<svg viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\">\n                <line x1=\"1\" y1=\"24\" \n                    x2=\"24\" y2=\"1\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n                <line x1=\"1\" y1=\"1\" \n                    x2=\"24\" y2=\"24\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n            </svg>`\n    }]\n  }], null, null);\n})();\n\nclass JoyrideButtonComponent {\n  constructor() {\n    this.clicked = new EventEmitter();\n  }\n\n  onClick() {\n    this.clicked.emit();\n  }\n\n}\n\nJoyrideButtonComponent.ɵfac = function JoyrideButtonComponent_Factory(t) {\n  return new (t || JoyrideButtonComponent)();\n};\n\nJoyrideButtonComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: JoyrideButtonComponent,\n  selectors: [[\"joyride-button\"]],\n  inputs: {\n    color: \"color\"\n  },\n  outputs: {\n    clicked: \"clicked\"\n  },\n  ngContentSelectors: _c1,\n  decls: 2,\n  vars: 5,\n  consts: [[1, \"joyride-button\", 3, \"ngStyle\", \"mouseleave\", \"mouseover\", \"click\"]],\n  template: function JoyrideButtonComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵprojectionDef();\n      i0.ɵɵelementStart(0, \"button\", 0);\n      i0.ɵɵlistener(\"mouseleave\", function JoyrideButtonComponent_Template_button_mouseleave_0_listener() {\n        return ctx.hover = false;\n      })(\"mouseover\", function JoyrideButtonComponent_Template_button_mouseover_0_listener() {\n        return ctx.hover = true;\n      })(\"click\", function JoyrideButtonComponent_Template_button_click_0_listener() {\n        return ctx.onClick();\n      });\n      i0.ɵɵprojection(1);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction3(1, _c0, ctx.hover ? \"#fff\" : ctx.color, ctx.hover ? ctx.color : \"#fff\", ctx.hover ? ctx.color : \"transparent\"));\n    }\n  },\n  directives: [i10.NgStyle],\n  styles: [\".joyride-button[_ngcontent-%COMP%]{text-transform:uppercase;border:2px solid transparent;outline:none;padding:6px 12px;font-size:12px;font-weight:700;color:#fff;background-color:#3b5560;cursor:pointer}.joyride-button[_ngcontent-%COMP%]:hover{color:#3b5560;border:2px solid #3b5560;background-color:#fff}\"]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideButtonComponent, [{\n    type: Component,\n    args: [{\n      selector: 'joyride-button',\n      template: \"<button (mouseleave)=\\\"hover=false\\\" (mouseover)=\\\"hover=true\\\"\\n    [ngStyle]=\\\"{'background-color': hover ? '#fff' : color, \\n                'color': hover ? color : '#fff',\\n                'border-color' : hover ? color : 'transparent'}\\\"\\n    class=\\\"joyride-button\\\" (click)=\\\"onClick()\\\">\\n    <ng-content></ng-content>\\n</button>\",\n      styles: [\".joyride-button{text-transform:uppercase;border:2px solid transparent;outline:none;padding:6px 12px;font-size:12px;font-weight:700;color:#fff;background-color:#3b5560;cursor:pointer}.joyride-button:hover{color:#3b5560;border:2px solid #3b5560;background-color:#fff}\\n\"]\n    }]\n  }], null, {\n    color: [{\n      type: Input\n    }],\n    clicked: [{\n      type: Output\n    }]\n  });\n})();\n\nconst STEP_MIN_WIDTH = 200;\nconst STEP_MAX_WIDTH = 400;\nconst CUSTOM_STEP_MAX_WIDTH_VW = 90;\nconst STEP_HEIGHT = 200;\nconst ASPECT_RATIO = 1.212;\nconst DEFAULT_DISTANCE_FROM_MARGIN_TOP = 2;\nconst DEFAULT_DISTANCE_FROM_MARGIN_LEFT = 2;\nconst DEFAULT_DISTANCE_FROM_MARGIN_BOTTOM = 5;\nconst DEFAULT_DISTANCE_FROM_MARGIN_RIGHT = 5;\nvar KEY_CODE;\n\n(function (KEY_CODE) {\n  KEY_CODE[KEY_CODE[\"RIGHT_ARROW\"] = 39] = \"RIGHT_ARROW\";\n  KEY_CODE[KEY_CODE[\"LEFT_ARROW\"] = 37] = \"LEFT_ARROW\";\n  KEY_CODE[KEY_CODE[\"ESCAPE_KEY\"] = 27] = \"ESCAPE_KEY\";\n})(KEY_CODE || (KEY_CODE = {}));\n\nclass JoyrideStepComponent {\n  constructor(injector, stepsContainerService, eventListenerService, documentService, renderer, logger, optionsService, templateService) {\n    this.injector = injector;\n    this.stepsContainerService = stepsContainerService;\n    this.eventListenerService = eventListenerService;\n    this.documentService = documentService;\n    this.renderer = renderer;\n    this.logger = logger;\n    this.optionsService = optionsService;\n    this.templateService = templateService;\n    this.stepWidth = STEP_MIN_WIDTH;\n    this.stepHeight = STEP_HEIGHT;\n    this.showArrow = true;\n    this.arrowSize = ARROW_SIZE;\n    this.subscriptions = [];\n  }\n\n  ngOnInit() {\n    // Need to Inject here otherwise you will obtain a circular dependency\n    this.joyrideStepService = this.injector.get(JoyrideStepService);\n    this.documentHeight = this.documentService.getDocumentHeight();\n    this.subscriptions.push(this.subscribeToResizeEvents());\n    this.title = this.step.title.asObservable();\n    this.text = this.step.text.asObservable();\n    this.setCustomTemplates();\n    this.setCustomTexts();\n    this.counter = this.getCounter();\n    this.isCounterVisible = this.optionsService.isCounterVisible();\n    this.isPrevButtonVisible = this.optionsService.isPrevButtonVisible();\n    this.themeColor = this.optionsService.getThemeColor();\n    if (this.text) this.text.subscribe(val => this.checkRedraw(val));\n    if (this.title) this.title.subscribe(val => this.checkRedraw(val));\n  }\n\n  ngAfterViewInit() {\n    if (this.isCustomized()) {\n      this.renderer.setStyle(this.stepContainer.nativeElement, 'max-width', CUSTOM_STEP_MAX_WIDTH_VW + 'vw');\n      this.updateStepDimensions();\n    } else {\n      this.renderer.setStyle(this.stepContainer.nativeElement, 'max-width', STEP_MAX_WIDTH + 'px');\n      let dimensions = this.getDimensionsByAspectRatio(this.stepContainer.nativeElement.clientWidth, this.stepContainer.nativeElement.clientHeight, ASPECT_RATIO);\n      dimensions = this.adjustDimensions(dimensions.width, dimensions.height);\n      this.stepWidth = dimensions.width;\n      this.stepHeight = dimensions.height;\n      this.renderer.setStyle(this.stepContainer.nativeElement, 'width', this.stepWidth + 'px');\n      this.renderer.setStyle(this.stepContainer.nativeElement, 'height', this.stepHeight + 'px');\n    }\n\n    this.drawStep();\n  }\n\n  checkRedraw(val) {\n    if (val != null) {\n      // Need to wait that the change is rendered before redrawing\n      setTimeout(() => {\n        this.redrawStep();\n      }, 2);\n    }\n  }\n\n  isCustomized() {\n    return this.step.stepContent || this.templateService.getCounter() || this.templateService.getPrevButton() || this.templateService.getNextButton() || this.templateService.getDoneButton();\n  }\n\n  setCustomTexts() {\n    const customeTexts = this.optionsService.getCustomTexts();\n    this.prevText = customeTexts.prev;\n    this.nextText = customeTexts.next;\n    this.doneText = customeTexts.done;\n  }\n\n  drawStep() {\n    let position = this.step.isElementOrAncestorFixed ? 'fixed' : 'absolute';\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'position', position);\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'transform', this.step.transformCssStyle);\n    this.targetWidth = this.step.targetViewContainer.element.nativeElement.getBoundingClientRect().width;\n    this.targetHeight = this.step.targetViewContainer.element.nativeElement.getBoundingClientRect().height;\n    this.targetAbsoluteLeft = position === 'fixed' ? this.documentService.getElementFixedLeft(this.step.targetViewContainer.element) : this.documentService.getElementAbsoluteLeft(this.step.targetViewContainer.element);\n    this.targetAbsoluteTop = position === 'fixed' ? this.documentService.getElementFixedTop(this.step.targetViewContainer.element) : this.documentService.getElementAbsoluteTop(this.step.targetViewContainer.element);\n    this.setStepStyle();\n  }\n\n  getCounter() {\n    let stepPosition = this.stepsContainerService.getStepNumber(this.step.name);\n    let numberOfSteps = this.stepsContainerService.getStepsCount();\n    this.counterData = {\n      step: stepPosition,\n      total: numberOfSteps\n    };\n    return stepPosition + '/' + numberOfSteps;\n  }\n\n  setCustomTemplates() {\n    this.customContent = this.step.stepContent;\n    this.ctx = this.step.stepContentParams;\n    this.customPrevButton = this.templateService.getPrevButton();\n    this.customNextButton = this.templateService.getNextButton();\n    this.customDoneButton = this.templateService.getDoneButton();\n    this.customCounter = this.templateService.getCounter();\n  }\n\n  keyEvent(event) {\n    console.log(event);\n\n    if (event.keyCode === KEY_CODE.RIGHT_ARROW) {\n      if (this.isLastStep()) {\n        this.close();\n      } else {\n        this.next();\n      }\n    } else if (event.keyCode === KEY_CODE.LEFT_ARROW) {\n      this.prev();\n    } else if (event.keyCode === KEY_CODE.ESCAPE_KEY) {\n      this.close();\n    }\n  }\n\n  prev() {\n    this.joyrideStepService.prev();\n  }\n\n  next() {\n    this.joyrideStepService.next();\n  }\n\n  close() {\n    this.joyrideStepService.close();\n  }\n\n  isFirstStep() {\n    return this.stepsContainerService.getStepNumber(this.step.name) === 1;\n  }\n\n  isLastStep() {\n    return this.stepsContainerService.getStepNumber(this.step.name) === this.stepsContainerService.getStepsCount();\n  }\n\n  setStepStyle() {\n    switch (this.step.position) {\n      case 'top':\n        {\n          this.setStyleTop();\n          break;\n        }\n\n      case 'bottom':\n        {\n          this.setStyleBottom();\n          break;\n        }\n\n      case 'right':\n        {\n          this.setStyleRight();\n          break;\n        }\n\n      case 'left':\n        {\n          this.setStyleLeft();\n          break;\n        }\n\n      case 'center':\n        {\n          this.setStyleCenter();\n          break;\n        }\n\n      default:\n        {\n          this.setStyleBottom();\n        }\n    }\n  }\n\n  setStyleTop() {\n    this.stepsContainerService.updatePosition(this.step.name, 'top');\n    this.topPosition = this.targetAbsoluteTop - DISTANCE_FROM_TARGET - this.stepHeight;\n    this.stepAbsoluteTop = this.targetAbsoluteTop - DISTANCE_FROM_TARGET - this.stepHeight;\n    this.arrowTopPosition = this.stepHeight;\n    this.leftPosition = this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n    this.stepAbsoluteLeft = this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n    this.arrowLeftPosition = this.stepWidth / 2 - this.arrowSize;\n    this.adjustLeftPosition();\n    this.adjustRightPosition();\n    this.arrowPosition = 'bottom';\n    this.autofixTopPosition();\n  }\n\n  setStyleRight() {\n    this.stepsContainerService.updatePosition(this.step.name, 'right');\n    this.topPosition = this.targetAbsoluteTop + this.targetHeight / 2 - this.stepHeight / 2;\n    this.stepAbsoluteTop = this.targetAbsoluteTop + this.targetHeight / 2 - this.stepHeight / 2;\n    this.arrowTopPosition = this.stepHeight / 2 - this.arrowSize;\n    this.leftPosition = this.targetAbsoluteLeft + this.targetWidth + DISTANCE_FROM_TARGET;\n    this.stepAbsoluteLeft = this.targetAbsoluteLeft + this.targetWidth + DISTANCE_FROM_TARGET;\n    this.arrowLeftPosition = -this.arrowSize;\n    this.adjustTopPosition();\n    this.adjustBottomPosition();\n    this.arrowPosition = 'left';\n    this.autofixRightPosition();\n  }\n\n  setStyleBottom() {\n    this.stepsContainerService.updatePosition(this.step.name, 'bottom');\n    this.topPosition = this.targetAbsoluteTop + this.targetHeight + DISTANCE_FROM_TARGET;\n    this.stepAbsoluteTop = this.targetAbsoluteTop + this.targetHeight + DISTANCE_FROM_TARGET;\n    this.arrowTopPosition = -this.arrowSize;\n    this.arrowLeftPosition = this.stepWidth / 2 - this.arrowSize;\n    this.leftPosition = this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n    this.stepAbsoluteLeft = this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n    this.adjustLeftPosition();\n    this.adjustRightPosition();\n    this.arrowPosition = 'top';\n    this.autofixBottomPosition();\n  }\n\n  setStyleLeft() {\n    this.stepsContainerService.updatePosition(this.step.name, 'left');\n    this.topPosition = this.targetAbsoluteTop + this.targetHeight / 2 - this.stepHeight / 2;\n    this.stepAbsoluteTop = this.targetAbsoluteTop + this.targetHeight / 2 - this.stepHeight / 2;\n    this.arrowTopPosition = this.stepHeight / 2 - this.arrowSize;\n    this.leftPosition = this.targetAbsoluteLeft - this.stepWidth - DISTANCE_FROM_TARGET;\n    this.stepAbsoluteLeft = this.targetAbsoluteLeft - this.stepWidth - DISTANCE_FROM_TARGET;\n    this.arrowLeftPosition = this.stepWidth;\n    this.adjustTopPosition();\n    this.adjustBottomPosition();\n    this.arrowPosition = 'right';\n    this.autofixLeftPosition();\n  }\n\n  setStyleCenter() {\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'position', 'fixed');\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'top', '50%');\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'left', '50%');\n    this.updateStepDimensions();\n    this.renderer.setStyle(this.stepHolder.nativeElement, 'transform', `translate(-${this.stepWidth / 2}px, -${this.stepHeight / 2}px)`);\n    this.showArrow = false;\n  }\n\n  adjustLeftPosition() {\n    if (this.leftPosition < 0) {\n      this.arrowLeftPosition = this.arrowLeftPosition + this.leftPosition - DEFAULT_DISTANCE_FROM_MARGIN_LEFT;\n      this.leftPosition = DEFAULT_DISTANCE_FROM_MARGIN_LEFT;\n    }\n  }\n\n  adjustRightPosition() {\n    let currentWindowWidth = document.body.clientWidth;\n\n    if (this.stepAbsoluteLeft + this.stepWidth > currentWindowWidth) {\n      let newLeftPos = this.leftPosition - (this.stepAbsoluteLeft + this.stepWidth + DEFAULT_DISTANCE_FROM_MARGIN_RIGHT - currentWindowWidth);\n      let deltaLeftPosition = newLeftPos - this.leftPosition;\n      this.leftPosition = newLeftPos;\n      this.arrowLeftPosition = this.arrowLeftPosition - deltaLeftPosition;\n    }\n  }\n\n  adjustTopPosition() {\n    if (this.stepAbsoluteTop < 0) {\n      this.arrowTopPosition = this.arrowTopPosition + this.topPosition - DEFAULT_DISTANCE_FROM_MARGIN_TOP;\n      this.topPosition = DEFAULT_DISTANCE_FROM_MARGIN_TOP;\n    }\n  }\n\n  adjustBottomPosition() {\n    if (this.stepAbsoluteTop + this.stepHeight > this.documentHeight) {\n      let newTopPos = this.topPosition - (this.stepAbsoluteTop + this.stepHeight + DEFAULT_DISTANCE_FROM_MARGIN_BOTTOM - this.documentHeight);\n      let deltaTopPosition = newTopPos - this.topPosition;\n      this.topPosition = newTopPos;\n      this.arrowTopPosition = this.arrowTopPosition - deltaTopPosition;\n    }\n  }\n\n  autofixTopPosition() {\n    if (this.positionAlreadyFixed) {\n      this.logger.warn('No step positions found for this step. The step will be centered.');\n    } else if (this.targetAbsoluteTop - this.stepHeight - this.arrowSize < 0) {\n      this.positionAlreadyFixed = true;\n      this.setStyleRight();\n    }\n  }\n\n  autofixRightPosition() {\n    if (this.targetAbsoluteLeft + this.targetWidth + this.stepWidth + this.arrowSize > document.body.clientWidth) {\n      this.setStyleBottom();\n    }\n  }\n\n  autofixBottomPosition() {\n    if (this.targetAbsoluteTop + this.stepHeight + this.arrowSize + this.targetHeight > this.documentHeight) {\n      this.setStyleLeft();\n    }\n  }\n\n  autofixLeftPosition() {\n    if (this.targetAbsoluteLeft - this.stepWidth - this.arrowSize < 0) {\n      this.setStyleTop();\n    }\n  }\n\n  subscribeToResizeEvents() {\n    return this.eventListenerService.resizeEvent.subscribe(() => {\n      this.redrawStep();\n    });\n  }\n\n  redrawStep() {\n    this.updateStepDimensions();\n    this.drawStep();\n  }\n\n  getDimensionsByAspectRatio(width, height, aspectRatio) {\n    let calcHeight = (width + height) / (1 + aspectRatio);\n    let calcWidth = calcHeight * aspectRatio;\n    return {\n      width: calcWidth,\n      height: calcHeight\n    };\n  }\n\n  adjustDimensions(width, height) {\n    let area = width * height;\n    let newWidth = width;\n    let newHeight = height;\n\n    if (width > STEP_MAX_WIDTH) {\n      newWidth = STEP_MAX_WIDTH;\n      newHeight = area / newWidth;\n    } else if (width < STEP_MIN_WIDTH) {\n      newWidth = STEP_MIN_WIDTH;\n      newHeight = STEP_MIN_WIDTH / ASPECT_RATIO;\n    }\n\n    return {\n      width: newWidth,\n      height: newHeight\n    };\n  }\n\n  updateStepDimensions() {\n    this.stepWidth = this.stepContainer.nativeElement.clientWidth;\n    this.stepHeight = this.stepContainer.nativeElement.clientHeight;\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach(subscription => {\n      subscription.unsubscribe();\n    });\n  }\n\n}\n\nJoyrideStepComponent.ɵfac = function JoyrideStepComponent_Factory(t) {\n  return new (t || JoyrideStepComponent)(i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(JoyrideStepsContainerService), i0.ɵɵdirectiveInject(EventListenerService), i0.ɵɵdirectiveInject(DocumentService), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(LoggerService), i0.ɵɵdirectiveInject(JoyrideOptionsService), i0.ɵɵdirectiveInject(TemplatesService));\n};\n\nJoyrideStepComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: JoyrideStepComponent,\n  selectors: [[\"joyride-step\"]],\n  viewQuery: function JoyrideStepComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c2, 7);\n      i0.ɵɵviewQuery(_c3, 7);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.stepHolder = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.stepContainer = _t.first);\n    }\n  },\n  hostBindings: function JoyrideStepComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"keyup\", function JoyrideStepComponent_keyup_HostBindingHandler($event) {\n        return ctx.keyEvent($event);\n      }, false, i0.ɵɵresolveWindow);\n    }\n  },\n  inputs: {\n    step: \"step\"\n  },\n  decls: 21,\n  vars: 17,\n  consts: [[1, \"joyride-step__holder\", 3, \"id\"], [\"stepHolder\", \"\"], [\"class\", \"joyride-step__arrow\", 3, \"position\", \"top\", \"left\", 4, \"ngIf\"], [1, \"joyride-step__container\"], [\"stepContainer\", \"\"], [1, \"joyride-step__close\", 3, \"click\"], [1, \"joyride-step__header\"], [1, \"joyride-step__title\"], [1, \"joyride-step__body\"], [4, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [\"defaultContent\", \"\"], [1, \"joyride-step__footer\"], [\"class\", \"joyride-step__counter-container\", 4, \"ngIf\"], [1, \"joyride-step__buttons-container\"], [\"class\", \"joyride-step__prev-container joyride-step__button\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"joyride-step__next-container joyride-step__button\", 3, \"click\", 4, \"ngIf\", \"ngIfElse\"], [\"doneButton\", \"\"], [1, \"joyride-step__arrow\", 3, \"position\"], [1, \"joyride-step__counter-container\"], [\"defaultCounter\", \"\"], [1, \"joyride-step__counter\"], [1, \"joyride-step__prev-container\", \"joyride-step__button\", 3, \"click\"], [4, \"ngTemplateOutlet\"], [\"defaultPrevButton\", \"\"], [1, \"joyride-step__prev-button\", 3, \"color\"], [1, \"joyride-step__next-container\", \"joyride-step__button\", 3, \"click\"], [\"defaulNextButton\", \"\"], [3, \"color\"], [1, \"joyride-step__done-container\", \"joyride-step__button\", 3, \"click\"], [\"defaultDoneButton\", \"\"], [1, \"joyride-step__done-button\", 3, \"color\"]],\n  template: function JoyrideStepComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0, 1);\n      i0.ɵɵtemplate(2, JoyrideStepComponent_joyride_arrow_2_Template, 1, 5, \"joyride-arrow\", 2);\n      i0.ɵɵelementStart(3, \"div\", 3, 4);\n      i0.ɵɵelementStart(5, \"joy-close-button\", 5);\n      i0.ɵɵlistener(\"click\", function JoyrideStepComponent_Template_joy_close_button_click_5_listener() {\n        return ctx.close();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 6);\n      i0.ɵɵelementStart(7, \"div\", 7);\n      i0.ɵɵtext(8);\n      i0.ɵɵpipe(9, \"async\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"div\", 8);\n      i0.ɵɵtemplate(11, JoyrideStepComponent_ng_container_11_Template, 1, 0, \"ng-container\", 9);\n      i0.ɵɵtemplate(12, JoyrideStepComponent_ng_template_12_Template, 2, 3, \"ng-template\", null, 10, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"div\", 11);\n      i0.ɵɵtemplate(15, JoyrideStepComponent_div_15_Template, 4, 2, \"div\", 12);\n      i0.ɵɵelementStart(16, \"div\", 13);\n      i0.ɵɵtemplate(17, JoyrideStepComponent_div_17_Template, 4, 1, \"div\", 14);\n      i0.ɵɵtemplate(18, JoyrideStepComponent_div_18_Template, 4, 1, \"div\", 15);\n      i0.ɵɵtemplate(19, JoyrideStepComponent_ng_template_19_Template, 4, 1, \"ng-template\", null, 16, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      const _r4 = i0.ɵɵreference(13);\n\n      const _r9 = i0.ɵɵreference(20);\n\n      i0.ɵɵstyleProp(\"top\", ctx.topPosition, \"px\")(\"left\", ctx.leftPosition, \"px\");\n      i0.ɵɵproperty(\"id\", \"joyride-step-\" + ctx.step.name);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.showArrow);\n      i0.ɵɵadvance(5);\n      i0.ɵɵstyleProp(\"color\", ctx.themeColor);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 15, ctx.title));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngTemplateOutlet\", ctx.customContent ? ctx.customContent : _r4)(\"ngTemplateOutletContext\", ctx.ctx);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.isCounterVisible);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isPrevButtonVisible && !ctx.isFirstStep());\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isLastStep())(\"ngIfElse\", _r9);\n    }\n  },\n  directives: [i10.NgIf, JoyrideCloseButtonComponent, i10.NgTemplateOutlet, JoyrideArrowComponent, JoyrideButtonComponent],\n  pipes: [i10.AsyncPipe],\n  styles: [\".joyride-step__holder{position:absolute;font-family:Arial,Helvetica,sans-serif;font-size:16px;z-index:1001}.joyride-step__arrow{position:absolute;left:40px;z-index:1002}.joyride-step__container{box-sizing:border-box;position:relative;color:#000;background-color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:10px;box-shadow:0 0 30px 1px #000}.joyride-step__header{display:flex;align-items:center;padding:8px}.joyride-step__title{font-weight:700;font-size:20px}.joyride-step__close{position:absolute;right:10px;top:10px;width:14px;height:14px;cursor:pointer}.joyride-step__body{text-align:left;padding:10px 8px}.joyride-step__footer{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px}.joyride-step__buttons-container{display:flex;flex-direction:row}.joyride-step__button:first-child{margin-right:2.5px}.joyride-step__button:last-child{margin-left:2.5px}.joyride-step__counter{font-weight:700;font-size:14px}.joyride-step__counter-container{margin-right:10px}\\n\"],\n  encapsulation: 2\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideStepComponent, [{\n    type: Component,\n    args: [{\n      selector: 'joyride-step',\n      encapsulation: ViewEncapsulation.None,\n      template: \"<div #stepHolder class=\\\"joyride-step__holder\\\" [id]=\\\"'joyride-step-' + step.name\\\" [style.top.px]=\\\"topPosition\\\" [style.left.px]=\\\"leftPosition\\\">\\n    <joyride-arrow *ngIf=\\\"showArrow\\\" class=\\\"joyride-step__arrow\\\" [position]=\\\"arrowPosition\\\" [style.top.px]=\\\"arrowTopPosition\\\"\\n        [style.left.px]=\\\"arrowLeftPosition\\\"></joyride-arrow>\\n    <div #stepContainer class=\\\"joyride-step__container\\\">\\n        <joy-close-button class=\\\"joyride-step__close\\\" (click)=\\\"close()\\\"></joy-close-button>\\n        <div class=\\\"joyride-step__header\\\">\\n            <div class=\\\"joyride-step__title\\\" [style.color]=\\\"themeColor\\\">{{ title | async }}</div>\\n        </div>\\n        <div class=\\\"joyride-step__body\\\">\\n            <ng-container *ngTemplateOutlet=\\\"customContent ? customContent : defaultContent; context: ctx\\\"></ng-container>\\n            <ng-template #defaultContent>\\n                {{ text | async }}\\n            </ng-template>\\n        </div>\\n        <div class=\\\"joyride-step__footer\\\">\\n            <div *ngIf=\\\"isCounterVisible\\\" class=\\\"joyride-step__counter-container\\\">\\n                <ng-container *ngTemplateOutlet=\\\"customCounter ? customCounter : defaultCounter; context: counterData\\\"></ng-container>\\n                <ng-template #defaultCounter>\\n                    <div class=\\\"joyride-step__counter\\\">{{ counter }}</div>\\n                </ng-template>\\n            </div>\\n            <div class=\\\"joyride-step__buttons-container\\\">\\n                <div class=\\\"joyride-step__prev-container joyride-step__button\\\" *ngIf=\\\"isPrevButtonVisible && !isFirstStep()\\\" (click)=\\\"prev()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customPrevButton ? customPrevButton : defaultPrevButton\\\"></ng-container>\\n                    <ng-template #defaultPrevButton>\\n                        <joyride-button class=\\\"joyride-step__prev-button\\\" [color]=\\\"themeColor\\\">{{ prevText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <div class=\\\"joyride-step__next-container joyride-step__button\\\" *ngIf=\\\"!isLastStep(); else doneButton\\\" (click)=\\\"next()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customNextButton ? customNextButton : defaulNextButton\\\"></ng-container>\\n                    <ng-template #defaulNextButton>\\n                        <joyride-button [color]=\\\"themeColor\\\">{{ nextText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <ng-template #doneButton>\\n                    <div class=\\\"joyride-step__done-container joyride-step__button\\\" (click)=\\\"close()\\\">\\n                        <ng-container *ngTemplateOutlet=\\\"customDoneButton ? customDoneButton : defaultDoneButton\\\"></ng-container>\\n                        <ng-template #defaultDoneButton>\\n                            <joyride-button class=\\\"joyride-step__done-button\\\" [color]=\\\"themeColor\\\">{{ doneText | async }}</joyride-button>\\n                        </ng-template>\\n                    </div>\\n                </ng-template>\\n            </div>\\n        </div>\\n    </div>\\n</div>\",\n      styles: [\".joyride-step__holder{position:absolute;font-family:Arial,Helvetica,sans-serif;font-size:16px;z-index:1001}.joyride-step__arrow{position:absolute;left:40px;z-index:1002}.joyride-step__container{box-sizing:border-box;position:relative;color:#000;background-color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:10px;box-shadow:0 0 30px 1px #000}.joyride-step__header{display:flex;align-items:center;padding:8px}.joyride-step__title{font-weight:700;font-size:20px}.joyride-step__close{position:absolute;right:10px;top:10px;width:14px;height:14px;cursor:pointer}.joyride-step__body{text-align:left;padding:10px 8px}.joyride-step__footer{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px}.joyride-step__buttons-container{display:flex;flex-direction:row}.joyride-step__button:first-child{margin-right:2.5px}.joyride-step__button:last-child{margin-left:2.5px}.joyride-step__counter{font-weight:700;font-size:14px}.joyride-step__counter-container{margin-right:10px}\\n\"]\n    }]\n  }], function () {\n    return [{\n      type: i0.Injector\n    }, {\n      type: JoyrideStepsContainerService\n    }, {\n      type: EventListenerService\n    }, {\n      type: DocumentService\n    }, {\n      type: i0.Renderer2\n    }, {\n      type: LoggerService\n    }, {\n      type: JoyrideOptionsService\n    }, {\n      type: TemplatesService\n    }];\n  }, {\n    step: [{\n      type: Input\n    }],\n    stepHolder: [{\n      type: ViewChild,\n      args: ['stepHolder', {\n        static: true\n      }]\n    }],\n    stepContainer: [{\n      type: ViewChild,\n      args: ['stepContainer', {\n        static: true\n      }]\n    }],\n    keyEvent: [{\n      type: HostListener,\n      args: ['window:keyup', ['$event']]\n    }]\n  });\n})();\n\nclass StepDrawerService {\n  constructor(componentFactoryResolver, appRef, injector) {\n    this.componentFactoryResolver = componentFactoryResolver;\n    this.appRef = appRef;\n    this.injector = injector;\n    this.refMap = {};\n  }\n\n  draw(step) {\n    // 1. Create a component reference from the component\n    const ref = this.componentFactoryResolver.resolveComponentFactory(JoyrideStepComponent).create(this.injector); // 2. Attach component to the appRef so that it's inside the ng component tree\n\n    this.appRef.attachView(ref.hostView); // 3. Get DOM element from component\n\n    const domElem = ref.hostView.rootNodes[0]; // 4. Append DOM element to the body\n\n    document.body.appendChild(domElem);\n    const instance = ref.instance;\n    instance.step = step;\n    ref.changeDetectorRef.detectChanges();\n    step.stepInstance = instance;\n    this.refMap[step.name] = ref;\n  }\n\n  remove(step) {\n    this.appRef.detachView(this.refMap[step.name].hostView);\n    this.refMap[step.name].destroy();\n  }\n\n}\n\nStepDrawerService.ɵfac = function StepDrawerService_Factory(t) {\n  return new (t || StepDrawerService)(i0.ɵɵinject(i0.ComponentFactoryResolver), i0.ɵɵinject(i0.ApplicationRef), i0.ɵɵinject(i0.Injector));\n};\n\nStepDrawerService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: StepDrawerService,\n  factory: StepDrawerService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(StepDrawerService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i0.ComponentFactoryResolver\n    }, {\n      type: i0.ApplicationRef\n    }, {\n      type: i0.Injector\n    }];\n  }, null);\n})();\n\nconst SCROLLBAR_SIZE = 20;\nconst DISTANCE_FROM_TARGET = 15;\nconst ARROW_SIZE = 10;\n\nclass JoyrideStepService {\n  constructor(backDropService, eventListener, stepsContainerService, documentService, DOMService, stepDrawerService, optionsService, router, logger) {\n    this.backDropService = backDropService;\n    this.eventListener = eventListener;\n    this.stepsContainerService = stepsContainerService;\n    this.documentService = documentService;\n    this.DOMService = DOMService;\n    this.stepDrawerService = stepDrawerService;\n    this.optionsService = optionsService;\n    this.router = router;\n    this.logger = logger;\n    this.winTopPosition = 0;\n    this.winBottomPosition = 0;\n    this.stepsObserver = new ReplaySubject();\n    this.initViewportPositions();\n    this.subscribeToScrollEvents();\n    this.subscribeToResizeEvents();\n  }\n\n  initViewportPositions() {\n    this.winTopPosition = 0;\n    this.winBottomPosition = this.DOMService.getNativeWindow().innerHeight - SCROLLBAR_SIZE;\n  }\n\n  subscribeToScrollEvents() {\n    this.eventListener.startListeningScrollEvents();\n    this.eventListener.scrollEvent.subscribe(scroll => {\n      this.winTopPosition = scroll.scrollY;\n      this.winBottomPosition = this.winTopPosition + this.DOMService.getNativeWindow().innerHeight - SCROLLBAR_SIZE;\n      if (this.currentStep) this.backDropService.redraw(this.currentStep, scroll);\n    });\n  }\n\n  subscribeToResizeEvents() {\n    this.eventListener.resizeEvent.subscribe(() => {\n      if (this.currentStep) this.backDropService.redrawTarget(this.currentStep);\n    });\n  }\n\n  drawStep(step) {\n    step.position = step.position === NO_POSITION ? this.optionsService.getStepDefaultPosition() : step.position;\n    this.stepDrawerService.draw(step);\n  }\n\n  startTour() {\n    this.stepsObserver = new ReplaySubject();\n    this.stepsContainerService.init();\n    this.documentService.setDocumentHeight();\n    this.tryShowStep(StepActionType.NEXT);\n    this.eventListener.startListeningResizeEvents();\n    this.subscribeToStepsUpdates();\n    return this.stepsObserver.asObservable();\n  }\n\n  close() {\n    this.removeCurrentStep();\n    this.notifyTourIsFinished();\n    this.DOMService.getNativeWindow().scrollTo(0, 0);\n    this.eventListener.stopListeningResizeEvents();\n    this.backDropService.remove();\n  }\n\n  prev() {\n    this.removeCurrentStep();\n    this.currentStep.prevCliked.emit();\n    this.tryShowStep(StepActionType.PREV);\n  }\n\n  next() {\n    this.removeCurrentStep();\n    this.currentStep.nextClicked.emit();\n    this.tryShowStep(StepActionType.NEXT);\n  }\n\n  async navigateToStepPage(action) {\n    let stepRoute = this.stepsContainerService.getStepRoute(action);\n\n    if (stepRoute) {\n      return await this.router.navigate([stepRoute]);\n    }\n  }\n\n  subscribeToStepsUpdates() {\n    this.stepsContainerService.stepHasBeenModified.subscribe(updatedStep => {\n      if (this.currentStep && this.currentStep.name === updatedStep.name) {\n        this.currentStep = updatedStep;\n      }\n    });\n  }\n\n  async tryShowStep(actionType) {\n    await this.navigateToStepPage(actionType);\n    const timeout = this.optionsService.getWaitingTime();\n    if (timeout > 100) this.backDropService.remove();\n    setTimeout(() => {\n      try {\n        this.showStep(actionType);\n      } catch (error) {\n        if (error instanceof JoyrideStepDoesNotExist) {\n          this.tryShowStep(actionType);\n        } else if (error instanceof JoyrideStepOutOfRange) {\n          this.logger.error('Forcing the tour closure: First or Last step not found in the DOM.');\n          this.close();\n        } else {\n          throw new Error(error);\n        }\n      }\n    }, timeout);\n  }\n\n  showStep(actionType) {\n    this.currentStep = this.stepsContainerService.get(actionType);\n    if (this.currentStep == null) throw new JoyrideStepDoesNotExist('');\n    this.notifyStepClicked(actionType); // Scroll the element to get it visible if it's in a scrollable element\n\n    this.scrollIfElementBeyondOtherElements();\n    this.backDropService.draw(this.currentStep);\n    this.drawStep(this.currentStep);\n    this.scrollIfStepAndTargetAreNotVisible();\n  }\n\n  notifyStepClicked(actionType) {\n    let stepInfo = {\n      number: this.stepsContainerService.getStepNumber(this.currentStep.name),\n      name: this.currentStep.name,\n      route: this.currentStep.route,\n      actionType\n    };\n    this.stepsObserver.next(stepInfo);\n  }\n\n  notifyTourIsFinished() {\n    if (this.currentStep) this.currentStep.tourDone.emit();\n    this.stepsObserver.complete();\n  }\n\n  removeCurrentStep() {\n    if (this.currentStep) this.stepDrawerService.remove(this.currentStep);\n  }\n\n  scrollIfStepAndTargetAreNotVisible() {\n    this.scrollWhenTargetOrStepAreHiddenBottom();\n    this.scrollWhenTargetOrStepAreHiddenTop();\n  }\n\n  scrollWhenTargetOrStepAreHiddenBottom() {\n    let totalTargetBottom = this.getMaxTargetAndStepBottomPosition();\n\n    if (totalTargetBottom > this.winBottomPosition) {\n      this.DOMService.getNativeWindow().scrollBy(0, totalTargetBottom - this.winBottomPosition);\n    }\n  }\n\n  scrollWhenTargetOrStepAreHiddenTop() {\n    let totalTargetTop = this.getMaxTargetAndStepTopPosition();\n\n    if (totalTargetTop < this.winTopPosition) {\n      this.DOMService.getNativeWindow().scrollBy(0, totalTargetTop - this.winTopPosition);\n    }\n  }\n\n  getMaxTargetAndStepBottomPosition() {\n    let targetAbsoluteTop = this.documentService.getElementAbsoluteTop(this.currentStep.targetViewContainer.element);\n\n    if (this.currentStep.position === 'top') {\n      return targetAbsoluteTop + this.currentStep.stepInstance.targetHeight;\n    } else if (this.currentStep.position === 'bottom') {\n      return targetAbsoluteTop + this.currentStep.stepInstance.targetHeight + this.currentStep.stepInstance.stepHeight + ARROW_SIZE + DISTANCE_FROM_TARGET;\n    } else if (this.currentStep.position === 'right' || this.currentStep.position === 'left') {\n      return Math.max(targetAbsoluteTop + this.currentStep.stepInstance.targetHeight, targetAbsoluteTop + this.currentStep.stepInstance.targetHeight / 2 + this.currentStep.stepInstance.stepHeight / 2);\n    }\n  }\n\n  getMaxTargetAndStepTopPosition() {\n    let targetAbsoluteTop = this.documentService.getElementAbsoluteTop(this.currentStep.targetViewContainer.element);\n\n    if (this.currentStep.position === 'top') {\n      return targetAbsoluteTop - (this.currentStep.stepInstance.stepHeight + ARROW_SIZE + DISTANCE_FROM_TARGET);\n    } else if (this.currentStep.position === 'bottom') {\n      return targetAbsoluteTop;\n    } else if (this.currentStep.position === 'right' || this.currentStep.position === 'left') {\n      return Math.min(targetAbsoluteTop, targetAbsoluteTop + this.currentStep.stepInstance.targetHeight / 2 - this.currentStep.stepInstance.stepHeight / 2);\n    }\n  }\n\n  scrollIfElementBeyondOtherElements() {\n    if (this.isElementBeyondOthers() === 2) {\n      this.documentService.scrollToTheTop(this.currentStep.targetViewContainer.element);\n    }\n\n    if (this.isElementBeyondOthers() === 2) {\n      this.documentService.scrollToTheBottom(this.currentStep.targetViewContainer.element);\n    }\n\n    if (this.isElementBeyondOthers() === 1 && this.documentService.isParentScrollable(this.currentStep.targetViewContainer.element)) {\n      this.documentService.scrollIntoView(this.currentStep.targetViewContainer.element, this.currentStep.isElementOrAncestorFixed);\n    }\n\n    if (this.isElementBeyondOthers() === 1 && this.documentService.isParentScrollable(this.currentStep.targetViewContainer.element)) {\n      this.currentStep.targetViewContainer.element.nativeElement.scrollIntoView();\n    }\n  }\n\n  isElementBeyondOthers() {\n    return this.documentService.isElementBeyondOthers(this.currentStep.targetViewContainer.element, this.currentStep.isElementOrAncestorFixed, 'backdrop');\n  }\n\n}\n\nJoyrideStepService.ɵfac = function JoyrideStepService_Factory(t) {\n  return new (t || JoyrideStepService)(i0.ɵɵinject(JoyrideBackdropService), i0.ɵɵinject(EventListenerService), i0.ɵɵinject(JoyrideStepsContainerService), i0.ɵɵinject(DocumentService), i0.ɵɵinject(DomRefService), i0.ɵɵinject(StepDrawerService), i0.ɵɵinject(JoyrideOptionsService), i0.ɵɵinject(i3.Router), i0.ɵɵinject(LoggerService));\n};\n\nJoyrideStepService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: JoyrideStepService,\n  factory: JoyrideStepService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideStepService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: JoyrideBackdropService\n    }, {\n      type: EventListenerService\n    }, {\n      type: JoyrideStepsContainerService\n    }, {\n      type: DocumentService\n    }, {\n      type: DomRefService\n    }, {\n      type: StepDrawerService\n    }, {\n      type: JoyrideOptionsService\n    }, {\n      type: i3.Router\n    }, {\n      type: LoggerService\n    }];\n  }, null);\n})();\n\nclass JoyrideService {\n  constructor(platformId, stepService, optionsService) {\n    this.platformId = platformId;\n    this.stepService = stepService;\n    this.optionsService = optionsService;\n    this.tourInProgress = false;\n  }\n\n  startTour(options) {\n    if (!isPlatformBrowser(this.platformId)) {\n      return of(new JoyrideStepInfo());\n    }\n\n    if (!this.tourInProgress) {\n      this.tourInProgress = true;\n\n      if (options) {\n        this.optionsService.setOptions(options);\n      }\n\n      this.tour$ = this.stepService.startTour().pipe(finalize(() => this.tourInProgress = false));\n      this.tour$.subscribe();\n    }\n\n    return this.tour$;\n  }\n\n  closeTour() {\n    if (this.isTourInProgress()) this.stepService.close();\n  }\n\n  isTourInProgress() {\n    return this.tourInProgress;\n  }\n\n}\n\nJoyrideService.ɵfac = function JoyrideService_Factory(t) {\n  return new (t || JoyrideService)(i0.ɵɵinject(PLATFORM_ID), i0.ɵɵinject(JoyrideStepService), i0.ɵɵinject(JoyrideOptionsService));\n};\n\nJoyrideService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: JoyrideService,\n  factory: JoyrideService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: Object,\n      decorators: [{\n        type: Inject,\n        args: [PLATFORM_ID]\n      }]\n    }, {\n      type: JoyrideStepService\n    }, {\n      type: JoyrideOptionsService\n    }];\n  }, null);\n})();\n\nconst routerModuleForChild = RouterModule.forChild([]);\n\nclass JoyrideModule {\n  static forRoot() {\n    return {\n      ngModule: JoyrideModule,\n      providers: [JoyrideService, JoyrideStepService, JoyrideStepsContainerService, JoyrideBackdropService, EventListenerService, DocumentService, JoyrideOptionsService, StepDrawerService, DomRefService, LoggerService, TemplatesService]\n    };\n  }\n\n  static forChild() {\n    return {\n      ngModule: JoyrideModule,\n      providers: []\n    };\n  }\n\n}\n\nJoyrideModule.ɵfac = function JoyrideModule_Factory(t) {\n  return new (t || JoyrideModule)();\n};\n\nJoyrideModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: JoyrideModule\n});\nJoyrideModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  imports: [[CommonModule, routerModuleForChild]]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(JoyrideModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule, routerModuleForChild],\n      declarations: [JoyrideDirective, JoyrideStepComponent, JoyrideArrowComponent, JoyrideButtonComponent, JoyrideCloseButtonComponent],\n      exports: [JoyrideDirective]\n    }]\n  }], null, null);\n})();\n/*\n * Public API Surface of ngx-joyride\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { ARROW_SIZE, DEFAULT_DISTANCE_FROM_MARGIN_LEFT, DEFAULT_DISTANCE_FROM_MARGIN_TOP, DEFAULT_TEXTS, DEFAULT_THEME_COLOR, DEFAULT_TIMEOUT_BETWEEN_STEPS, DISTANCE_FROM_TARGET, DocumentService, DomRefService, EventListenerService, JoyrideArrowComponent, JoyrideBackdropService, JoyrideButtonComponent, JoyrideCloseButtonComponent, JoyrideDirective, JoyrideModule, JoyrideOptionsService, JoyrideService, JoyrideStepComponent, JoyrideStepService, JoyrideStepsContainerService, KEY_CODE, LoggerService, NO_POSITION, ObservableCustomTexts, STEP_DEFAULT_POSITION, Scroll, StepActionType, StepDrawerService, TemplatesService, routerModuleForChild }; //# sourceMappingURL=ngx-joyride.mjs.map","map":{"version":3,"names":["i0","Injectable","PLATFORM_ID","Inject","EventEmitter","Directive","Input","Output","Component","ViewEncapsulation","ViewChild","HostListener","NgModule","i10","isPlatformBrowser","CommonModule","ReplaySubject","of","Observable","Subject","i3","RouterModule","finalize","JoyrideStep","constructor","title","text","JoyrideError","Error","message","Object","setPrototypeOf","prototype","JoyrideStepDoesNotExist","JoyrideStepOutOfRange","DEFAULT_THEME_COLOR","STEP_DEFAULT_POSITION","DEFAULT_TIMEOUT_BETWEEN_STEPS","ObservableCustomTexts","DEFAULT_TEXTS","prev","next","done","close","JoyrideOptionsService","themeColor","stepDefaultPosition","logsEnabled","showCounter","showPrevButton","stepsOrder","setOptions","options","steps","firstStep","startWith","waitingTime","customTexts","setCustomText","getBackdropColor","hexToRgb","getThemeColor","getStepDefaultPosition","getStepsOrder","getFirstStep","getWaitingTime","areLogsEnabled","isCounterVisible","isPrevButtonVisible","getCustomTexts","texts","toObservable","value","hex","shorthandRegex","replace","m","r","g","b","result","exec","parseInt","ɵfac","ɵprov","type","JOYRIDE","LoggerService","optionService","debug","data","console","info","warn","error","ROUTE_SEPARATOR","Step","StepActionType","JoyrideStepsContainerService","stepOptions","logger","tempSteps","currentStepIndex","stepHasBeenModified","getFirstStepIndex","stepIds","index","indexOf","undefined","init","forEach","stepId","push","id","step","addStep","stepToAdd","stepExist","filter","name","length","stepIndexToReplace","findIndex","get","action","NEXT","stepName","getStepName","stepFound","getStepRoute","stepID","stepRoute","includes","split","updatePosition","position","getStepIndex","getStepNumber","getStepsCount","map","DomRefService","platformId","fakeDocument","body","documentElement","fakeWindow","document","navigator","getNativeWindow","window","getNativeDocument","decorators","args","TemplatesService","setPrevButton","template","_prevButton","getPrevButton","setNextButton","_nextButton","getNextButton","setDoneButton","_doneButton","getDoneButton","setCounter","_counter","getCounter","NO_POSITION","JoyrideDirective","joyrideStepsContainer","viewContainerRef","domService","router","templateService","stepPosition","subscriptions","windowRef","ngAfterViewInit","prevTemplate","nextTemplate","doneTemplate","counterTemplate","targetViewContainer","setAsyncFields","stepContent","stepContentParams","nextClicked","prevCliked","tourDone","route","url","substr","transformCssStyle","getComputedStyle","element","nativeElement","transform","isElementOrAncestorFixed","isElementFixed","isAncestorsFixed","parentElement","ngOnChanges","changes","subscribe","nodeName","ngOnDestroy","sub","unsubscribe","ViewContainerRef","Router","ɵdir","selector","nextStep","JoyrideStepInfo","DocumentService","DOMService","setDocumentHeight","doc","elementsFromPoint","bind","getElementFixedTop","elementRef","getBoundingClientRect","top","getElementFixedLeft","left","getElementAbsoluteTop","scrollOffsets","getScrollOffsets","y","getElementAbsoluteLeft","x","documentHeight","calculateDocumentHeight","getDocumentHeight","isParentScrollable","getFirstScrollableParent","isElementBeyondOthers","keywordToDiscard","x1","y1","x2","width","y2","height","elements1","elements2","getFirstElementWithoutKeyword","scrollIntoView","firstScrollableParent","scrollTo","scrollTop","scrollToTheTop","scrollToTheBottom","scrollHeight","clientHeight","node","regex","style","prop","getPropertyValue","scroll","test","scrollparent","parentNode","documentRef","Math","max","offsetHeight","winReference","docReference","pageXOffset","pageYOffset","compatMode","scrollLeft","parents","parent","elem","elementFromPoint","pointerEvents","elements","keyword","classList","toString","shift","JoyrideBackdropService","documentService","optionsService","rendererFactory","lastXScroll","lastYScroll","setRenderer","renderer","createRenderer","draw","targetAbsoluteTop","getTargetTotalTop","targetAbsoluteLeft","getTargetTotalLeft","currentBackdropContainer","createElement","addClass","setStyle","setAttribute","backdropContent","appendChild","backdropTop","backdropMiddleContainer","backdropMiddleContent","leftBackdrop","targetBackdrop","offsetWidth","rightBackdrop","backdropBottom","removeLastBackdrop","drawCurrentBackdrop","lastBackdropContainer","remove","redrawTarget","handleVerticalScroll","handleHorizontalScroll","targetVC","redraw","scrollY","scrollX","newBackdropLeftWidth","handleTargetPartialWidth","visibleTargetWidth","newBackdropTopHeight","handleTargetPartialHeight","visibleTargetHeight","removeChild","RendererFactory2","Scroll","EventListenerService","scrollEvent","resizeEvent","startListeningScrollEvents","scrollUnlisten","listen","evt","startListeningResizeEvents","resizeUnlisten","stopListeningScrollEvents","stopListeningResizeEvents","JoyrideArrowComponent","ɵcmp","encapsulation","None","styles","JoyrideCloseButtonComponent","JoyrideButtonComponent","clicked","onClick","emit","NgStyle","color","STEP_MIN_WIDTH","STEP_MAX_WIDTH","CUSTOM_STEP_MAX_WIDTH_VW","STEP_HEIGHT","ASPECT_RATIO","DEFAULT_DISTANCE_FROM_MARGIN_TOP","DEFAULT_DISTANCE_FROM_MARGIN_LEFT","DEFAULT_DISTANCE_FROM_MARGIN_BOTTOM","DEFAULT_DISTANCE_FROM_MARGIN_RIGHT","KEY_CODE","JoyrideStepComponent","injector","stepsContainerService","eventListenerService","stepWidth","stepHeight","showArrow","arrowSize","ARROW_SIZE","ngOnInit","joyrideStepService","JoyrideStepService","subscribeToResizeEvents","asObservable","setCustomTemplates","setCustomTexts","counter","val","checkRedraw","isCustomized","stepContainer","updateStepDimensions","dimensions","getDimensionsByAspectRatio","clientWidth","adjustDimensions","drawStep","setTimeout","redrawStep","customeTexts","prevText","nextText","doneText","stepHolder","targetWidth","targetHeight","setStepStyle","numberOfSteps","counterData","total","customContent","ctx","customPrevButton","customNextButton","customDoneButton","customCounter","keyEvent","event","log","keyCode","RIGHT_ARROW","isLastStep","LEFT_ARROW","ESCAPE_KEY","isFirstStep","setStyleTop","setStyleBottom","setStyleRight","setStyleLeft","setStyleCenter","topPosition","DISTANCE_FROM_TARGET","stepAbsoluteTop","arrowTopPosition","leftPosition","stepAbsoluteLeft","arrowLeftPosition","adjustLeftPosition","adjustRightPosition","arrowPosition","autofixTopPosition","adjustTopPosition","adjustBottomPosition","autofixRightPosition","autofixBottomPosition","autofixLeftPosition","currentWindowWidth","newLeftPos","deltaLeftPosition","newTopPos","deltaTopPosition","positionAlreadyFixed","aspectRatio","calcHeight","calcWidth","area","newWidth","newHeight","subscription","Injector","Renderer2","NgIf","NgTemplateOutlet","AsyncPipe","static","StepDrawerService","componentFactoryResolver","appRef","refMap","ref","resolveComponentFactory","create","attachView","hostView","domElem","rootNodes","instance","changeDetectorRef","detectChanges","stepInstance","detachView","destroy","ComponentFactoryResolver","ApplicationRef","SCROLLBAR_SIZE","backDropService","eventListener","stepDrawerService","winTopPosition","winBottomPosition","stepsObserver","initViewportPositions","subscribeToScrollEvents","innerHeight","currentStep","startTour","tryShowStep","subscribeToStepsUpdates","removeCurrentStep","notifyTourIsFinished","PREV","navigateToStepPage","navigate","updatedStep","actionType","timeout","showStep","notifyStepClicked","scrollIfElementBeyondOtherElements","scrollIfStepAndTargetAreNotVisible","stepInfo","number","complete","scrollWhenTargetOrStepAreHiddenBottom","scrollWhenTargetOrStepAreHiddenTop","totalTargetBottom","getMaxTargetAndStepBottomPosition","scrollBy","totalTargetTop","getMaxTargetAndStepTopPosition","min","JoyrideService","stepService","tourInProgress","tour$","pipe","closeTour","isTourInProgress","routerModuleForChild","forChild","JoyrideModule","forRoot","ngModule","providers","ɵmod","ɵinj","imports","declarations","exports"],"sources":["/home/bethel/Documents/work/angular/cuba/node_modules/ngx-joyride/fesm2020/ngx-joyride.mjs","/home/bethel/Documents/work/angular/cuba/projects/ngx-joyride/src/lib/components/step/joyride-step.component.html","/home/bethel/Documents/work/angular/cuba/projects/ngx-joyride/src/lib/components/arrow/arrow.component.html","/home/bethel/Documents/work/angular/cuba/projects/ngx-joyride/src/lib/components/button/button.component.html"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, PLATFORM_ID, Inject, EventEmitter, Directive, Input, Output, Component, ViewEncapsulation, ViewChild, HostListener, NgModule } from '@angular/core';\nimport * as i10 from '@angular/common';\nimport { isPlatformBrowser, CommonModule } from '@angular/common';\nimport { ReplaySubject, of, Observable, Subject } from 'rxjs';\nimport * as i3 from '@angular/router';\nimport { RouterModule } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nclass JoyrideStep {\n    constructor() {\n        this.title = new ReplaySubject();\n        this.text = new ReplaySubject();\n    }\n}\n\nclass JoyrideError extends Error {\n    constructor(message) {\n        super(message);\n        Object.setPrototypeOf(this, JoyrideError.prototype);\n    }\n}\nclass JoyrideStepDoesNotExist extends Error {\n    constructor(message) {\n        super(message);\n        Object.setPrototypeOf(this, JoyrideStepDoesNotExist.prototype);\n    }\n}\nclass JoyrideStepOutOfRange extends Error {\n    constructor(message) {\n        super(message);\n        Object.setPrototypeOf(this, JoyrideStepOutOfRange.prototype);\n    }\n}\n\nconst DEFAULT_THEME_COLOR = '#3b5560';\nconst STEP_DEFAULT_POSITION = 'bottom';\nconst DEFAULT_TIMEOUT_BETWEEN_STEPS = 1;\nclass ObservableCustomTexts {\n}\nconst DEFAULT_TEXTS = {\n    prev: of('prev'),\n    next: of('next'),\n    done: of('done'),\n    close: of(null)\n};\nclass JoyrideOptionsService {\n    constructor() {\n        this.themeColor = DEFAULT_THEME_COLOR;\n        this.stepDefaultPosition = STEP_DEFAULT_POSITION;\n        this.logsEnabled = false;\n        this.showCounter = true;\n        this.showPrevButton = true;\n        this.stepsOrder = [];\n    }\n    setOptions(options) {\n        this.stepsOrder = options.steps;\n        this.stepDefaultPosition = options.stepDefaultPosition\n            ? options.stepDefaultPosition\n            : this.stepDefaultPosition;\n        this.logsEnabled =\n            typeof options.logsEnabled !== 'undefined'\n                ? options.logsEnabled\n                : this.logsEnabled;\n        this.showCounter =\n            typeof options.showCounter !== 'undefined'\n                ? options.showCounter\n                : this.showCounter;\n        this.showPrevButton =\n            typeof options.showPrevButton !== 'undefined'\n                ? options.showPrevButton\n                : this.showPrevButton;\n        this.themeColor = options.themeColor\n            ? options.themeColor\n            : this.themeColor;\n        this.firstStep = options.startWith;\n        this.waitingTime =\n            typeof options.waitingTime !== 'undefined'\n                ? options.waitingTime\n                : DEFAULT_TIMEOUT_BETWEEN_STEPS;\n        typeof options.customTexts !== 'undefined'\n            ? this.setCustomText(options.customTexts)\n            : this.setCustomText(DEFAULT_TEXTS);\n    }\n    getBackdropColor() {\n        return this.hexToRgb(this.themeColor);\n    }\n    getThemeColor() {\n        return this.themeColor;\n    }\n    getStepDefaultPosition() {\n        return this.stepDefaultPosition;\n    }\n    getStepsOrder() {\n        return this.stepsOrder;\n    }\n    getFirstStep() {\n        return this.firstStep;\n    }\n    getWaitingTime() {\n        return this.waitingTime;\n    }\n    areLogsEnabled() {\n        return this.logsEnabled;\n    }\n    isCounterVisible() {\n        return this.showCounter;\n    }\n    isPrevButtonVisible() {\n        return this.showPrevButton;\n    }\n    getCustomTexts() {\n        return this.customTexts;\n    }\n    setCustomText(texts) {\n        let prev;\n        let next;\n        let done;\n        let close;\n        prev = texts.prev ? texts.prev : DEFAULT_TEXTS.prev;\n        next = texts.next ? texts.next : DEFAULT_TEXTS.next;\n        done = texts.done ? texts.done : DEFAULT_TEXTS.done;\n        close = texts.close ? texts.close : DEFAULT_TEXTS.close;\n        this.customTexts = {\n            prev: this.toObservable(prev),\n            next: this.toObservable(next),\n            done: this.toObservable(done),\n            close: this.toObservable(close)\n        };\n    }\n    toObservable(value) {\n        return value instanceof Observable ? value : of(value);\n    }\n    hexToRgb(hex) {\n        const shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n        hex = hex.replace(shorthandRegex, (m, r, g, b) => {\n            return r + r + g + g + b + b;\n        });\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result\n            ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}`\n            : null;\n    }\n}\nJoyrideOptionsService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideOptionsService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nJoyrideOptionsService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideOptionsService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideOptionsService, decorators: [{\n            type: Injectable\n        }] });\n\nconst JOYRIDE = 'ngx-joyride:::';\nclass LoggerService {\n    constructor(optionService) {\n        this.optionService = optionService;\n    }\n    debug(message, data = \"\") {\n        if (this.optionService.areLogsEnabled()) {\n            console.debug(JOYRIDE + message, data);\n        }\n    }\n    info(message, data = \"\") {\n        if (this.optionService.areLogsEnabled()) {\n            console.info(JOYRIDE + message, data);\n        }\n    }\n    warn(message, data = \"\") {\n        if (this.optionService.areLogsEnabled()) {\n            console.warn(JOYRIDE + message, data);\n        }\n    }\n    error(message, data = \"\") {\n        if (this.optionService.areLogsEnabled()) {\n            console.error(JOYRIDE + message, data);\n        }\n    }\n}\nLoggerService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: LoggerService, deps: [{ token: JoyrideOptionsService }], target: i0.ɵɵFactoryTarget.Injectable });\nLoggerService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: LoggerService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: LoggerService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: JoyrideOptionsService }]; } });\n\nconst ROUTE_SEPARATOR = '@';\nclass Step {\n}\nvar StepActionType;\n(function (StepActionType) {\n    StepActionType[\"NEXT\"] = \"NEXT\";\n    StepActionType[\"PREV\"] = \"PREV\";\n})(StepActionType || (StepActionType = {}));\nclass JoyrideStepsContainerService {\n    constructor(stepOptions, logger) {\n        this.stepOptions = stepOptions;\n        this.logger = logger;\n        this.tempSteps = [];\n        this.currentStepIndex = -2;\n        this.stepHasBeenModified = new Subject();\n    }\n    getFirstStepIndex() {\n        const firstStep = this.stepOptions.getFirstStep();\n        const stepIds = this.stepOptions.getStepsOrder();\n        let index = stepIds.indexOf(firstStep);\n        if (index < 0) {\n            index = 0;\n            if (firstStep !== undefined)\n                this.logger.warn(`The step ${firstStep} does not exist. Check in your step list if it's present.`);\n        }\n        return index;\n    }\n    init() {\n        this.logger.info('Initializing the steps array.');\n        this.steps = [];\n        this.currentStepIndex = this.getFirstStepIndex() - 1;\n        let stepIds = this.stepOptions.getStepsOrder();\n        stepIds.forEach(stepId => this.steps.push({ id: stepId, step: null }));\n    }\n    addStep(stepToAdd) {\n        let stepExist = this.tempSteps.filter(step => step.name === stepToAdd.name).length > 0;\n        if (!stepExist) {\n            this.logger.info(`Adding step ${stepToAdd.name} to the steps list.`);\n            this.tempSteps.push(stepToAdd);\n        }\n        else {\n            let stepIndexToReplace = this.tempSteps.findIndex(step => step.name === stepToAdd.name);\n            this.tempSteps[stepIndexToReplace] = stepToAdd;\n        }\n    }\n    get(action) {\n        if (action === StepActionType.NEXT)\n            this.currentStepIndex++;\n        else\n            this.currentStepIndex--;\n        if (this.currentStepIndex < 0 || this.currentStepIndex >= this.steps.length)\n            throw new JoyrideStepOutOfRange('The first or last step of the tour cannot be found!');\n        const stepName = this.getStepName(this.steps[this.currentStepIndex].id);\n        const index = this.tempSteps.findIndex(step => step.name === stepName);\n        let stepFound = this.tempSteps[index];\n        this.steps[this.currentStepIndex].step = stepFound;\n        if (stepFound == null) {\n            this.logger.warn(`Step ${this.steps[this.currentStepIndex].id} not found in the DOM. Check if it's hidden by *ngIf directive.`);\n        }\n        return stepFound;\n    }\n    getStepRoute(action) {\n        let stepID;\n        if (action === StepActionType.NEXT) {\n            stepID = this.steps[this.currentStepIndex + 1] ? this.steps[this.currentStepIndex + 1].id : null;\n        }\n        else {\n            stepID = this.steps[this.currentStepIndex - 1] ? this.steps[this.currentStepIndex - 1].id : null;\n        }\n        let stepRoute = stepID && stepID.includes(ROUTE_SEPARATOR) ? stepID.split(ROUTE_SEPARATOR)[1] : '';\n        return stepRoute;\n    }\n    updatePosition(stepName, position) {\n        let index = this.getStepIndex(stepName);\n        if (this.steps[index].step) {\n            this.steps[index].step.position = position;\n            this.stepHasBeenModified.next(this.steps[index].step);\n        }\n        else {\n            this.logger.warn(`Trying to modify the position of ${stepName} to ${position}. Step not found!Is this step located in a different route?`);\n        }\n    }\n    getStepNumber(stepName) {\n        return this.getStepIndex(stepName) + 1;\n    }\n    getStepsCount() {\n        let stepsOrder = this.stepOptions.getStepsOrder();\n        return stepsOrder.length;\n    }\n    getStepIndex(stepName) {\n        const index = this.steps\n            .map(step => (step.id.includes(ROUTE_SEPARATOR) ? step.id.split(ROUTE_SEPARATOR)[0] : step.id))\n            .findIndex(name => stepName === name);\n        if (index === -1)\n            throw new JoyrideError(`The step with name: ${stepName} does not exist in the step list.`);\n        return index;\n    }\n    getStepName(stepID) {\n        let stepName = stepID && stepID.includes(ROUTE_SEPARATOR) ? stepID.split(ROUTE_SEPARATOR)[0] : stepID;\n        return stepName;\n    }\n}\nJoyrideStepsContainerService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepsContainerService, deps: [{ token: JoyrideOptionsService }, { token: LoggerService }], target: i0.ɵɵFactoryTarget.Injectable });\nJoyrideStepsContainerService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepsContainerService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepsContainerService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: JoyrideOptionsService }, { type: LoggerService }]; } });\n\nclass DomRefService {\n    constructor(platformId) {\n        this.platformId = platformId;\n        this.fakeDocument = { body: {}, documentElement: {} };\n        this.fakeWindow = { document: this.fakeDocument, navigator: {} };\n    }\n    getNativeWindow() {\n        if (isPlatformBrowser(this.platformId))\n            return window;\n        else\n            return this.fakeWindow;\n    }\n    getNativeDocument() {\n        if (isPlatformBrowser(this.platformId))\n            return document;\n        else\n            return this.fakeDocument;\n    }\n}\nDomRefService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DomRefService, deps: [{ token: PLATFORM_ID }], target: i0.ɵɵFactoryTarget.Injectable });\nDomRefService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DomRefService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DomRefService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: Object, decorators: [{\n                    type: Inject,\n                    args: [PLATFORM_ID]\n                }] }]; } });\n\nclass TemplatesService {\n    setPrevButton(template) {\n        this._prevButton = template;\n    }\n    getPrevButton() {\n        return this._prevButton;\n    }\n    setNextButton(template) {\n        this._nextButton = template;\n    }\n    getNextButton() {\n        return this._nextButton;\n    }\n    setDoneButton(template) {\n        this._doneButton = template;\n    }\n    getDoneButton() {\n        return this._doneButton;\n    }\n    setCounter(template) {\n        this._counter = template;\n    }\n    getCounter() {\n        return this._counter;\n    }\n}\nTemplatesService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: TemplatesService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nTemplatesService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: TemplatesService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: TemplatesService, decorators: [{\n            type: Injectable\n        }] });\n\nconst NO_POSITION = 'NO_POSITION';\nclass JoyrideDirective {\n    constructor(joyrideStepsContainer, viewContainerRef, domService, router, templateService, platformId) {\n        this.joyrideStepsContainer = joyrideStepsContainer;\n        this.viewContainerRef = viewContainerRef;\n        this.domService = domService;\n        this.router = router;\n        this.templateService = templateService;\n        this.platformId = platformId;\n        this.stepPosition = NO_POSITION;\n        this.prev = new EventEmitter();\n        this.next = new EventEmitter();\n        this.done = new EventEmitter();\n        this.subscriptions = [];\n        this.windowRef = this.domService.getNativeWindow();\n        this.step = new JoyrideStep();\n    }\n    ngAfterViewInit() {\n        if (!isPlatformBrowser(this.platformId))\n            return;\n        if (this.prevTemplate)\n            this.templateService.setPrevButton(this.prevTemplate);\n        if (this.nextTemplate)\n            this.templateService.setNextButton(this.nextTemplate);\n        if (this.doneTemplate)\n            this.templateService.setDoneButton(this.doneTemplate);\n        if (this.counterTemplate)\n            this.templateService.setCounter(this.counterTemplate);\n        this.step.position = this.stepPosition;\n        this.step.targetViewContainer = this.viewContainerRef;\n        this.setAsyncFields(this.step);\n        this.step.stepContent = this.stepContent;\n        this.step.stepContentParams = this.stepContentParams;\n        this.step.nextClicked = this.next;\n        this.step.prevCliked = this.prev;\n        this.step.tourDone = this.done;\n        if (!this.name)\n            throw new JoyrideError(\"All the steps should have the 'joyrideStep' property set with a custom name.\");\n        this.step.name = this.name;\n        this.step.route = this.router.url.substr(0, 1) === '/' ? this.router.url.substr(1) : this.router.url;\n        this.step.transformCssStyle = this.windowRef.getComputedStyle(this.viewContainerRef.element.nativeElement).transform;\n        this.step.isElementOrAncestorFixed =\n            this.isElementFixed(this.viewContainerRef.element) ||\n                this.isAncestorsFixed(this.viewContainerRef.element.nativeElement.parentElement);\n        this.joyrideStepsContainer.addStep(this.step);\n    }\n    ngOnChanges(changes) {\n        if (changes['title'] || changes['text']) {\n            this.setAsyncFields(this.step);\n        }\n    }\n    isElementFixed(element) {\n        return this.windowRef.getComputedStyle(element.nativeElement).position === 'fixed';\n    }\n    setAsyncFields(step) {\n        if (this.title instanceof Observable) {\n            this.subscriptions.push(this.title.subscribe(title => {\n                step.title.next(title);\n            }));\n        }\n        else {\n            step.title.next(this.title);\n        }\n        if (this.text instanceof Observable) {\n            this.subscriptions.push(this.text.subscribe(text => {\n                step.text.next(text);\n            }));\n        }\n        else {\n            step.text.next(this.text);\n        }\n    }\n    isAncestorsFixed(nativeElement) {\n        if (!nativeElement || !nativeElement.parentElement)\n            return false;\n        let isElementFixed = this.windowRef.getComputedStyle(nativeElement.parentElement).position === 'fixed';\n        if (nativeElement.nodeName === 'BODY') {\n            return isElementFixed;\n        }\n        if (isElementFixed)\n            return true;\n        else\n            return this.isAncestorsFixed(nativeElement.parentElement);\n    }\n    ngOnDestroy() {\n        this.subscriptions.forEach(sub => {\n            sub.unsubscribe();\n        });\n    }\n}\nJoyrideDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideDirective, deps: [{ token: JoyrideStepsContainerService }, { token: i0.ViewContainerRef }, { token: DomRefService }, { token: i3.Router }, { token: TemplatesService }, { token: PLATFORM_ID }], target: i0.ɵɵFactoryTarget.Directive });\nJoyrideDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"12.0.0\", version: \"13.1.1\", type: JoyrideDirective, selector: \"joyrideStep, [joyrideStep]\", inputs: { name: [\"joyrideStep\", \"name\"], nextStep: \"nextStep\", title: \"title\", text: \"text\", stepPosition: \"stepPosition\", stepContent: \"stepContent\", stepContentParams: \"stepContentParams\", prevTemplate: \"prevTemplate\", nextTemplate: \"nextTemplate\", doneTemplate: \"doneTemplate\", counterTemplate: \"counterTemplate\" }, outputs: { prev: \"prev\", next: \"next\", done: \"done\" }, usesOnChanges: true, ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideDirective, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: 'joyrideStep, [joyrideStep]'\n                }]\n        }], ctorParameters: function () { return [{ type: JoyrideStepsContainerService }, { type: i0.ViewContainerRef }, { type: DomRefService }, { type: i3.Router }, { type: TemplatesService }, { type: Object, decorators: [{\n                    type: Inject,\n                    args: [PLATFORM_ID]\n                }] }]; }, propDecorators: { name: [{\n                type: Input,\n                args: ['joyrideStep']\n            }], nextStep: [{\n                type: Input\n            }], title: [{\n                type: Input\n            }], text: [{\n                type: Input\n            }], stepPosition: [{\n                type: Input\n            }], stepContent: [{\n                type: Input\n            }], stepContentParams: [{\n                type: Input\n            }], prevTemplate: [{\n                type: Input\n            }], nextTemplate: [{\n                type: Input\n            }], doneTemplate: [{\n                type: Input\n            }], counterTemplate: [{\n                type: Input\n            }], prev: [{\n                type: Output\n            }], next: [{\n                type: Output\n            }], done: [{\n                type: Output\n            }] } });\n\nclass JoyrideStepInfo {\n}\n\nclass DocumentService {\n    constructor(DOMService, platformId) {\n        this.DOMService = DOMService;\n        if (!isPlatformBrowser(platformId)) {\n            return;\n        }\n        this.setDocumentHeight();\n        var doc = DOMService.getNativeDocument();\n        if (doc && !doc.elementsFromPoint) {\n            // IE 11 - Edge browsers\n            doc.elementsFromPoint = this.elementsFromPoint.bind(this);\n        }\n    }\n    getElementFixedTop(elementRef) {\n        return elementRef.nativeElement.getBoundingClientRect().top;\n    }\n    getElementFixedLeft(elementRef) {\n        return elementRef.nativeElement.getBoundingClientRect().left;\n    }\n    getElementAbsoluteTop(elementRef) {\n        const scrollOffsets = this.getScrollOffsets();\n        return (elementRef.nativeElement.getBoundingClientRect().top +\n            scrollOffsets.y);\n    }\n    getElementAbsoluteLeft(elementRef) {\n        const scrollOffsets = this.getScrollOffsets();\n        return (elementRef.nativeElement.getBoundingClientRect().left +\n            scrollOffsets.x);\n    }\n    setDocumentHeight() {\n        this.documentHeight = this.calculateDocumentHeight();\n    }\n    getDocumentHeight() {\n        return this.documentHeight;\n    }\n    isParentScrollable(elementRef) {\n        return (this.getFirstScrollableParent(elementRef.nativeElement) !==\n            this.DOMService.getNativeDocument().body);\n    }\n    isElementBeyondOthers(elementRef, isElementFixed, keywordToDiscard) {\n        const x1 = isElementFixed\n            ? this.getElementFixedLeft(elementRef)\n            : this.getElementAbsoluteLeft(elementRef);\n        const y1 = isElementFixed\n            ? this.getElementFixedTop(elementRef)\n            : this.getElementAbsoluteTop(elementRef);\n        const x2 = x1 + elementRef.nativeElement.getBoundingClientRect().width - 1;\n        const y2 = y1 + elementRef.nativeElement.getBoundingClientRect().height - 1;\n        const elements1 = this.DOMService.getNativeDocument().elementsFromPoint(x1, y1);\n        const elements2 = this.DOMService.getNativeDocument().elementsFromPoint(x2, y2);\n        if (elements1.length === 0 && elements2.length === 0)\n            return 1;\n        if (this.getFirstElementWithoutKeyword(elements1, keywordToDiscard) !==\n            elementRef.nativeElement ||\n            this.getFirstElementWithoutKeyword(elements2, keywordToDiscard) !==\n                elementRef.nativeElement) {\n            return 2;\n        }\n        return 3;\n    }\n    scrollIntoView(elementRef, isElementFixed) {\n        const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n        const top = isElementFixed\n            ? this.getElementFixedTop(elementRef)\n            : this.getElementAbsoluteTop(elementRef);\n        if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n            if (firstScrollableParent.scrollTo) {\n                firstScrollableParent.scrollTo(0, top - 150);\n            }\n            else {\n                // IE 11 - Edge browsers\n                firstScrollableParent.scrollTop = top - 150;\n            }\n        }\n        else {\n            this.DOMService.getNativeWindow().scrollTo(0, top - 150);\n        }\n    }\n    scrollToTheTop(elementRef) {\n        const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n        if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n            if (firstScrollableParent.scrollTo) {\n                firstScrollableParent.scrollTo(0, 0);\n            }\n            else {\n                // IE 11 - Edge browsers\n                firstScrollableParent.scrollTop = 0;\n            }\n        }\n        else {\n            this.DOMService.getNativeWindow().scrollTo(0, 0);\n        }\n    }\n    scrollToTheBottom(elementRef) {\n        const firstScrollableParent = this.getFirstScrollableParent(elementRef.nativeElement);\n        if (firstScrollableParent !== this.DOMService.getNativeDocument().body) {\n            if (firstScrollableParent.scrollTo) {\n                firstScrollableParent.scrollTo(0, this.DOMService.getNativeDocument().body.scrollHeight);\n            }\n            else {\n                // IE 11 - Edge browsers\n                firstScrollableParent.scrollTop =\n                    firstScrollableParent.scrollHeight -\n                        firstScrollableParent.clientHeight;\n            }\n        }\n        else {\n            this.DOMService.getNativeWindow().scrollTo(0, this.DOMService.getNativeDocument().body.scrollHeight);\n        }\n    }\n    getFirstScrollableParent(node) {\n        const regex = /(auto|scroll|overlay)/;\n        const style = (node, prop) => this.DOMService.getNativeWindow()\n            .getComputedStyle(node, null)\n            .getPropertyValue(prop);\n        const scroll = (node) => regex.test(style(node, 'overflow') +\n            style(node, 'overflow-y') +\n            style(node, 'overflow-x'));\n        const scrollparent = (node) => {\n            return !node || node === this.DOMService.getNativeDocument().body\n                ? this.DOMService.getNativeDocument().body\n                : scroll(node)\n                    ? node\n                    : scrollparent(node.parentNode);\n        };\n        return scrollparent(node);\n    }\n    calculateDocumentHeight() {\n        const documentRef = this.DOMService.getNativeDocument();\n        return Math.max(documentRef.body.scrollHeight, documentRef.documentElement.scrollHeight, documentRef.body.offsetHeight, documentRef.documentElement.offsetHeight, documentRef.body.clientHeight, documentRef.documentElement.clientHeight);\n    }\n    getScrollOffsets() {\n        const winReference = this.DOMService.getNativeWindow();\n        const docReference = this.DOMService.getNativeDocument();\n        // This works for all browsers except IE versions 8 and before\n        if (winReference.pageXOffset != null)\n            return { x: winReference.pageXOffset, y: winReference.pageYOffset };\n        // For IE (or any browser) in Standards mode\n        if (docReference.compatMode == 'CSS1Compat')\n            return {\n                x: docReference.documentElement.scrollLeft,\n                y: docReference.documentElement.scrollTop\n            };\n        // For browsers in Quirks mode\n        return {\n            x: docReference.body.scrollLeft,\n            y: docReference.body.scrollTop\n        };\n    }\n    elementsFromPoint(x, y) {\n        var parents = [];\n        var parent = void 0;\n        do {\n            const elem = this.DOMService.getNativeDocument().elementFromPoint(x, y);\n            if (elem && parent !== elem) {\n                parent = elem;\n                parents.push(parent);\n                parent.style.pointerEvents = 'none';\n            }\n            else {\n                parent = false;\n            }\n        } while (parent);\n        parents.forEach(function (parent) {\n            return (parent.style.pointerEvents = 'all');\n        });\n        return parents;\n    }\n    getFirstElementWithoutKeyword(elements, keyword) {\n        while (elements[0] &&\n            elements[0].classList.toString().includes(keyword)) {\n            elements.shift();\n        }\n        return elements[0];\n    }\n}\nDocumentService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DocumentService, deps: [{ token: DomRefService }, { token: PLATFORM_ID }], target: i0.ɵɵFactoryTarget.Injectable });\nDocumentService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DocumentService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: DocumentService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: DomRefService }, { type: Object, decorators: [{\n                    type: Inject,\n                    args: [PLATFORM_ID]\n                }] }]; } });\n\nclass JoyrideBackdropService {\n    constructor(documentService, optionsService, rendererFactory) {\n        this.documentService = documentService;\n        this.optionsService = optionsService;\n        this.rendererFactory = rendererFactory;\n        this.lastXScroll = 0;\n        this.lastYScroll = 0;\n        this.setRenderer();\n    }\n    setRenderer() {\n        this.renderer = this.rendererFactory.createRenderer(null, null);\n    }\n    draw(step) {\n        this.elementRef = step.targetViewContainer;\n        this.targetAbsoluteTop = this.getTargetTotalTop(step);\n        this.targetAbsoluteLeft = this.getTargetTotalLeft(step);\n        this.currentBackdropContainer = this.renderer.createElement('div');\n        this.renderer.addClass(this.currentBackdropContainer, 'backdrop-container');\n        this.renderer.setStyle(this.currentBackdropContainer, 'position', 'fixed');\n        this.renderer.setStyle(this.currentBackdropContainer, 'top', '0px');\n        this.renderer.setStyle(this.currentBackdropContainer, 'left', '0px');\n        this.renderer.setStyle(this.currentBackdropContainer, 'width', '100%');\n        this.renderer.setStyle(this.currentBackdropContainer, 'height', '100%');\n        this.renderer.setStyle(this.currentBackdropContainer, 'z-index', '1000');\n        this.renderer.setAttribute(this.currentBackdropContainer, 'id', 'backdrop-' + step.name);\n        this.backdropContent = this.renderer.createElement('div');\n        this.renderer.addClass(this.backdropContent, 'backdrop-content');\n        this.renderer.setStyle(this.backdropContent, 'position', 'relative');\n        this.renderer.setStyle(this.backdropContent, 'height', '100%');\n        this.renderer.setStyle(this.backdropContent, 'display', 'flex');\n        this.renderer.setStyle(this.backdropContent, 'flex-direction', 'column');\n        this.renderer.appendChild(this.currentBackdropContainer, this.backdropContent);\n        this.backdropTop = this.renderer.createElement('div');\n        this.renderer.addClass(this.backdropTop, 'joyride-backdrop');\n        this.renderer.addClass(this.backdropTop, 'backdrop-top');\n        this.renderer.setStyle(this.backdropTop, 'width', '100%');\n        this.renderer.setStyle(this.backdropTop, 'height', this.targetAbsoluteTop - this.lastYScroll + 'px');\n        this.renderer.setStyle(this.backdropTop, 'flex-shrink', '0');\n        this.renderer.setStyle(this.backdropTop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n        this.renderer.appendChild(this.backdropContent, this.backdropTop);\n        this.backdropMiddleContainer = this.renderer.createElement('div');\n        this.renderer.addClass(this.backdropMiddleContainer, 'backdrop-middle-container');\n        this.renderer.setStyle(this.backdropMiddleContainer, 'height', this.elementRef.element.nativeElement.offsetHeight + 'px');\n        this.renderer.setStyle(this.backdropMiddleContainer, 'width', '100%');\n        this.renderer.setStyle(this.backdropMiddleContainer, 'flex-shrink', '0');\n        this.renderer.appendChild(this.backdropContent, this.backdropMiddleContainer);\n        this.backdropMiddleContent = this.renderer.createElement('div');\n        this.renderer.addClass(this.backdropMiddleContent, 'backdrop-middle-content');\n        this.renderer.setStyle(this.backdropMiddleContent, 'display', 'flex');\n        this.renderer.setStyle(this.backdropMiddleContent, 'width', '100%');\n        this.renderer.setStyle(this.backdropMiddleContent, 'height', '100%');\n        this.renderer.appendChild(this.backdropMiddleContainer, this.backdropMiddleContent);\n        this.leftBackdrop = this.renderer.createElement('div');\n        this.renderer.addClass(this.leftBackdrop, 'joyride-backdrop');\n        this.renderer.addClass(this.leftBackdrop, 'backdrop-left');\n        this.renderer.setStyle(this.leftBackdrop, 'flex-shrink', '0');\n        this.renderer.setStyle(this.leftBackdrop, 'width', this.targetAbsoluteLeft - this.lastXScroll + 'px');\n        this.renderer.setStyle(this.leftBackdrop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n        this.renderer.appendChild(this.backdropMiddleContent, this.leftBackdrop);\n        this.targetBackdrop = this.renderer.createElement('div');\n        this.renderer.addClass(this.targetBackdrop, 'backdrop-target');\n        this.renderer.setStyle(this.targetBackdrop, 'flex-shrink', '0');\n        this.renderer.setStyle(this.targetBackdrop, 'width', this.elementRef.element.nativeElement.offsetWidth + 'px');\n        this.renderer.appendChild(this.backdropMiddleContent, this.targetBackdrop);\n        this.rightBackdrop = this.renderer.createElement('div');\n        this.renderer.addClass(this.rightBackdrop, 'joyride-backdrop');\n        this.renderer.addClass(this.rightBackdrop, 'backdrop-right');\n        this.renderer.setStyle(this.rightBackdrop, 'width', '100%');\n        this.renderer.setStyle(this.rightBackdrop, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n        this.renderer.appendChild(this.backdropMiddleContent, this.rightBackdrop);\n        this.backdropBottom = this.renderer.createElement('div');\n        this.renderer.addClass(this.backdropBottom, 'joyride-backdrop');\n        this.renderer.addClass(this.backdropBottom, 'backdrop-bottom');\n        this.renderer.setStyle(this.backdropBottom, 'width', '100%');\n        this.renderer.setStyle(this.backdropBottom, 'height', '100%');\n        this.renderer.setStyle(this.backdropBottom, 'background-color', `rgba(${this.optionsService.getBackdropColor()}, 0.7)`);\n        this.renderer.appendChild(this.backdropContent, this.backdropBottom);\n        this.removeLastBackdrop();\n        this.drawCurrentBackdrop();\n        this.lastBackdropContainer = this.currentBackdropContainer;\n    }\n    remove() {\n        this.removeLastBackdrop();\n    }\n    redrawTarget(step) {\n        this.targetAbsoluteLeft = this.getTargetTotalLeft(step);\n        this.targetAbsoluteTop = this.getTargetTotalTop(step);\n        this.handleVerticalScroll(step);\n        this.handleHorizontalScroll(step);\n    }\n    getTargetTotalTop(step) {\n        let targetVC = step.targetViewContainer;\n        return step.isElementOrAncestorFixed\n            ? this.documentService.getElementFixedTop(targetVC.element)\n            : this.documentService.getElementAbsoluteTop(targetVC.element);\n    }\n    getTargetTotalLeft(step) {\n        let targetVC = step.targetViewContainer;\n        return step.isElementOrAncestorFixed\n            ? this.documentService.getElementFixedLeft(targetVC.element)\n            : this.documentService.getElementAbsoluteLeft(targetVC.element);\n    }\n    redraw(step, scroll) {\n        if (this.lastYScroll !== scroll.scrollY) {\n            this.lastYScroll = scroll.scrollY;\n            if (this.elementRef) {\n                this.handleVerticalScroll(step);\n            }\n        }\n        if (this.lastXScroll !== scroll.scrollX) {\n            this.lastXScroll = scroll.scrollX;\n            if (this.elementRef) {\n                this.handleHorizontalScroll(step);\n            }\n        }\n    }\n    handleHorizontalScroll(step) {\n        let newBackdropLeftWidth = step.isElementOrAncestorFixed ? this.targetAbsoluteLeft : this.targetAbsoluteLeft - this.lastXScroll;\n        if (newBackdropLeftWidth >= 0) {\n            this.renderer.setStyle(this.leftBackdrop, 'width', newBackdropLeftWidth + 'px');\n            this.renderer.setStyle(this.targetBackdrop, 'width', this.elementRef.element.nativeElement.offsetWidth + 'px');\n        }\n        else {\n            this.handleTargetPartialWidth(newBackdropLeftWidth);\n        }\n    }\n    handleTargetPartialWidth(newBackdropLeftWidth) {\n        this.renderer.setStyle(this.leftBackdrop, 'width', 0 + 'px');\n        let visibleTargetWidth = this.elementRef.element.nativeElement.offsetWidth + newBackdropLeftWidth;\n        if (visibleTargetWidth >= 0) {\n            this.renderer.setStyle(this.targetBackdrop, 'width', visibleTargetWidth + 'px');\n        }\n        else {\n            this.renderer.setStyle(this.targetBackdrop, 'width', 0 + 'px');\n        }\n    }\n    handleVerticalScroll(step) {\n        let newBackdropTopHeight = step.isElementOrAncestorFixed ? this.targetAbsoluteTop : this.targetAbsoluteTop - this.lastYScroll;\n        if (newBackdropTopHeight >= 0) {\n            this.renderer.setStyle(this.backdropTop, 'height', newBackdropTopHeight + 'px');\n            this.renderer.setStyle(this.backdropMiddleContainer, 'height', this.elementRef.element.nativeElement.offsetHeight + 'px');\n        }\n        else {\n            this.handleTargetPartialHeight(newBackdropTopHeight);\n        }\n    }\n    handleTargetPartialHeight(newBackdropTopHeight) {\n        this.renderer.setStyle(this.backdropTop, 'height', 0 + 'px');\n        let visibleTargetHeight = this.elementRef.element.nativeElement.offsetHeight + newBackdropTopHeight;\n        if (visibleTargetHeight >= 0) {\n            this.renderer.setStyle(this.backdropMiddleContainer, 'height', visibleTargetHeight + 'px');\n        }\n        else {\n            this.renderer.setStyle(this.backdropMiddleContainer, 'height', 0 + 'px');\n        }\n    }\n    removeLastBackdrop() {\n        if (this.lastBackdropContainer) {\n            this.renderer.removeChild(document.body, this.lastBackdropContainer);\n            this.lastBackdropContainer = undefined;\n        }\n    }\n    drawCurrentBackdrop() {\n        this.renderer.appendChild(document.body, this.currentBackdropContainer);\n    }\n}\nJoyrideBackdropService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideBackdropService, deps: [{ token: DocumentService }, { token: JoyrideOptionsService }, { token: i0.RendererFactory2 }], target: i0.ɵɵFactoryTarget.Injectable });\nJoyrideBackdropService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideBackdropService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideBackdropService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: DocumentService }, { type: JoyrideOptionsService }, { type: i0.RendererFactory2 }]; } });\n\nclass Scroll {\n}\nclass EventListenerService {\n    constructor(rendererFactory, DOMService) {\n        this.rendererFactory = rendererFactory;\n        this.DOMService = DOMService;\n        this.scrollEvent = new Subject();\n        this.resizeEvent = new Subject();\n        this.renderer = rendererFactory.createRenderer(null, null);\n    }\n    startListeningScrollEvents() {\n        this.scrollUnlisten = this.renderer.listen('document', 'scroll', evt => {\n            this.scrollEvent.next({\n                scrollX: this.DOMService.getNativeWindow().pageXOffset,\n                scrollY: this.DOMService.getNativeWindow().pageYOffset\n            });\n        });\n    }\n    startListeningResizeEvents() {\n        this.resizeUnlisten = this.renderer.listen('window', 'resize', evt => {\n            this.resizeEvent.next(evt);\n        });\n    }\n    stopListeningScrollEvents() {\n        this.scrollUnlisten();\n    }\n    stopListeningResizeEvents() {\n        this.resizeUnlisten();\n    }\n}\nEventListenerService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: EventListenerService, deps: [{ token: i0.RendererFactory2 }, { token: DomRefService }], target: i0.ɵɵFactoryTarget.Injectable });\nEventListenerService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: EventListenerService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: EventListenerService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i0.RendererFactory2 }, { type: DomRefService }]; } });\n\nclass JoyrideArrowComponent {\n    constructor() {\n        this.position = 'top';\n    }\n}\nJoyrideArrowComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideArrowComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });\nJoyrideArrowComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"13.1.1\", type: JoyrideArrowComponent, selector: \"joyride-arrow\", inputs: { position: \"position\" }, ngImport: i0, template: \"<div [class.joyride-arrow__top]=\\\"position == 'top'\\\"\\n     [class.joyride-arrow__bottom]=\\\"position == 'bottom'\\\"\\n     [class.joyride-arrow__left]=\\\"position == 'left'\\\"\\n     [class.joyride-arrow__right]=\\\"position == 'right'\\\">\\n</div>\", styles: [\".joyride-arrow__top{border-left:11px solid transparent;border-right:11px solid transparent;border-bottom:11px solid #ffffff}.joyride-arrow__bottom{border-left:11px solid transparent;border-right:11px solid transparent;border-top:11px solid #ffffff}.joyride-arrow__right{border-left:11px solid #ffffff;border-bottom:11px solid transparent;border-top:11px solid transparent}.joyride-arrow__left{border-right:11px solid #ffffff;border-top:11px solid transparent;border-bottom:11px solid transparent}\\n\"], encapsulation: i0.ViewEncapsulation.None });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideArrowComponent, decorators: [{\n            type: Component,\n            args: [{ selector: 'joyride-arrow', encapsulation: ViewEncapsulation.None, template: \"<div [class.joyride-arrow__top]=\\\"position == 'top'\\\"\\n     [class.joyride-arrow__bottom]=\\\"position == 'bottom'\\\"\\n     [class.joyride-arrow__left]=\\\"position == 'left'\\\"\\n     [class.joyride-arrow__right]=\\\"position == 'right'\\\">\\n</div>\", styles: [\".joyride-arrow__top{border-left:11px solid transparent;border-right:11px solid transparent;border-bottom:11px solid #ffffff}.joyride-arrow__bottom{border-left:11px solid transparent;border-right:11px solid transparent;border-top:11px solid #ffffff}.joyride-arrow__right{border-left:11px solid #ffffff;border-bottom:11px solid transparent;border-top:11px solid transparent}.joyride-arrow__left{border-right:11px solid #ffffff;border-top:11px solid transparent;border-bottom:11px solid transparent}\\n\"] }]\n        }], propDecorators: { position: [{\n                type: Input\n            }] } });\n\nclass JoyrideCloseButtonComponent {\n}\nJoyrideCloseButtonComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideCloseButtonComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });\nJoyrideCloseButtonComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"13.1.1\", type: JoyrideCloseButtonComponent, selector: \"joy-close-button\", ngImport: i0, template: `<svg viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\">\n                <line x1=\"1\" y1=\"24\" \n                    x2=\"24\" y2=\"1\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n                <line x1=\"1\" y1=\"1\" \n                    x2=\"24\" y2=\"24\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n            </svg>`, isInline: true });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideCloseButtonComponent, decorators: [{\n            type: Component,\n            args: [{\n                    selector: 'joy-close-button',\n                    template: `<svg viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\">\n                <line x1=\"1\" y1=\"24\" \n                    x2=\"24\" y2=\"1\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n                <line x1=\"1\" y1=\"1\" \n                    x2=\"24\" y2=\"24\" \n                    stroke=\"black\" \n                    stroke-width=\"3\"/>\n            </svg>`\n                }]\n        }] });\n\nclass JoyrideButtonComponent {\n    constructor() {\n        this.clicked = new EventEmitter();\n    }\n    onClick() {\n        this.clicked.emit();\n    }\n}\nJoyrideButtonComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideButtonComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });\nJoyrideButtonComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"13.1.1\", type: JoyrideButtonComponent, selector: \"joyride-button\", inputs: { color: \"color\" }, outputs: { clicked: \"clicked\" }, ngImport: i0, template: \"<button (mouseleave)=\\\"hover=false\\\" (mouseover)=\\\"hover=true\\\"\\n    [ngStyle]=\\\"{'background-color': hover ? '#fff' : color, \\n                'color': hover ? color : '#fff',\\n                'border-color' : hover ? color : 'transparent'}\\\"\\n    class=\\\"joyride-button\\\" (click)=\\\"onClick()\\\">\\n    <ng-content></ng-content>\\n</button>\", styles: [\".joyride-button{text-transform:uppercase;border:2px solid transparent;outline:none;padding:6px 12px;font-size:12px;font-weight:700;color:#fff;background-color:#3b5560;cursor:pointer}.joyride-button:hover{color:#3b5560;border:2px solid #3b5560;background-color:#fff}\\n\"], directives: [{ type: i10.NgStyle, selector: \"[ngStyle]\", inputs: [\"ngStyle\"] }] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideButtonComponent, decorators: [{\n            type: Component,\n            args: [{ selector: 'joyride-button', template: \"<button (mouseleave)=\\\"hover=false\\\" (mouseover)=\\\"hover=true\\\"\\n    [ngStyle]=\\\"{'background-color': hover ? '#fff' : color, \\n                'color': hover ? color : '#fff',\\n                'border-color' : hover ? color : 'transparent'}\\\"\\n    class=\\\"joyride-button\\\" (click)=\\\"onClick()\\\">\\n    <ng-content></ng-content>\\n</button>\", styles: [\".joyride-button{text-transform:uppercase;border:2px solid transparent;outline:none;padding:6px 12px;font-size:12px;font-weight:700;color:#fff;background-color:#3b5560;cursor:pointer}.joyride-button:hover{color:#3b5560;border:2px solid #3b5560;background-color:#fff}\\n\"] }]\n        }], propDecorators: { color: [{\n                type: Input\n            }], clicked: [{\n                type: Output\n            }] } });\n\nconst STEP_MIN_WIDTH = 200;\nconst STEP_MAX_WIDTH = 400;\nconst CUSTOM_STEP_MAX_WIDTH_VW = 90;\nconst STEP_HEIGHT = 200;\nconst ASPECT_RATIO = 1.212;\nconst DEFAULT_DISTANCE_FROM_MARGIN_TOP = 2;\nconst DEFAULT_DISTANCE_FROM_MARGIN_LEFT = 2;\nconst DEFAULT_DISTANCE_FROM_MARGIN_BOTTOM = 5;\nconst DEFAULT_DISTANCE_FROM_MARGIN_RIGHT = 5;\nvar KEY_CODE;\n(function (KEY_CODE) {\n    KEY_CODE[KEY_CODE[\"RIGHT_ARROW\"] = 39] = \"RIGHT_ARROW\";\n    KEY_CODE[KEY_CODE[\"LEFT_ARROW\"] = 37] = \"LEFT_ARROW\";\n    KEY_CODE[KEY_CODE[\"ESCAPE_KEY\"] = 27] = \"ESCAPE_KEY\";\n})(KEY_CODE || (KEY_CODE = {}));\nclass JoyrideStepComponent {\n    constructor(injector, stepsContainerService, eventListenerService, documentService, renderer, logger, optionsService, templateService) {\n        this.injector = injector;\n        this.stepsContainerService = stepsContainerService;\n        this.eventListenerService = eventListenerService;\n        this.documentService = documentService;\n        this.renderer = renderer;\n        this.logger = logger;\n        this.optionsService = optionsService;\n        this.templateService = templateService;\n        this.stepWidth = STEP_MIN_WIDTH;\n        this.stepHeight = STEP_HEIGHT;\n        this.showArrow = true;\n        this.arrowSize = ARROW_SIZE;\n        this.subscriptions = [];\n    }\n    ngOnInit() {\n        // Need to Inject here otherwise you will obtain a circular dependency\n        this.joyrideStepService = this.injector.get(JoyrideStepService);\n        this.documentHeight = this.documentService.getDocumentHeight();\n        this.subscriptions.push(this.subscribeToResizeEvents());\n        this.title = this.step.title.asObservable();\n        this.text = this.step.text.asObservable();\n        this.setCustomTemplates();\n        this.setCustomTexts();\n        this.counter = this.getCounter();\n        this.isCounterVisible = this.optionsService.isCounterVisible();\n        this.isPrevButtonVisible = this.optionsService.isPrevButtonVisible();\n        this.themeColor = this.optionsService.getThemeColor();\n        if (this.text)\n            this.text.subscribe(val => this.checkRedraw(val));\n        if (this.title)\n            this.title.subscribe(val => this.checkRedraw(val));\n    }\n    ngAfterViewInit() {\n        if (this.isCustomized()) {\n            this.renderer.setStyle(this.stepContainer.nativeElement, 'max-width', CUSTOM_STEP_MAX_WIDTH_VW + 'vw');\n            this.updateStepDimensions();\n        }\n        else {\n            this.renderer.setStyle(this.stepContainer.nativeElement, 'max-width', STEP_MAX_WIDTH + 'px');\n            let dimensions = this.getDimensionsByAspectRatio(this.stepContainer.nativeElement.clientWidth, this.stepContainer.nativeElement.clientHeight, ASPECT_RATIO);\n            dimensions = this.adjustDimensions(dimensions.width, dimensions.height);\n            this.stepWidth = dimensions.width;\n            this.stepHeight = dimensions.height;\n            this.renderer.setStyle(this.stepContainer.nativeElement, 'width', this.stepWidth + 'px');\n            this.renderer.setStyle(this.stepContainer.nativeElement, 'height', this.stepHeight + 'px');\n        }\n        this.drawStep();\n    }\n    checkRedraw(val) {\n        if (val != null) {\n            // Need to wait that the change is rendered before redrawing\n            setTimeout(() => {\n                this.redrawStep();\n            }, 2);\n        }\n    }\n    isCustomized() {\n        return (this.step.stepContent ||\n            this.templateService.getCounter() ||\n            this.templateService.getPrevButton() ||\n            this.templateService.getNextButton() ||\n            this.templateService.getDoneButton());\n    }\n    setCustomTexts() {\n        const customeTexts = this.optionsService.getCustomTexts();\n        this.prevText = customeTexts.prev;\n        this.nextText = customeTexts.next;\n        this.doneText = customeTexts.done;\n    }\n    drawStep() {\n        let position = this.step.isElementOrAncestorFixed\n            ? 'fixed'\n            : 'absolute';\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'position', position);\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'transform', this.step.transformCssStyle);\n        this.targetWidth = this.step.targetViewContainer.element.nativeElement.getBoundingClientRect().width;\n        this.targetHeight = this.step.targetViewContainer.element.nativeElement.getBoundingClientRect().height;\n        this.targetAbsoluteLeft =\n            position === 'fixed'\n                ? this.documentService.getElementFixedLeft(this.step.targetViewContainer.element)\n                : this.documentService.getElementAbsoluteLeft(this.step.targetViewContainer.element);\n        this.targetAbsoluteTop =\n            position === 'fixed'\n                ? this.documentService.getElementFixedTop(this.step.targetViewContainer.element)\n                : this.documentService.getElementAbsoluteTop(this.step.targetViewContainer.element);\n        this.setStepStyle();\n    }\n    getCounter() {\n        let stepPosition = this.stepsContainerService.getStepNumber(this.step.name);\n        let numberOfSteps = this.stepsContainerService.getStepsCount();\n        this.counterData = { step: stepPosition, total: numberOfSteps };\n        return stepPosition + '/' + numberOfSteps;\n    }\n    setCustomTemplates() {\n        this.customContent = this.step.stepContent;\n        this.ctx = this.step.stepContentParams;\n        this.customPrevButton = this.templateService.getPrevButton();\n        this.customNextButton = this.templateService.getNextButton();\n        this.customDoneButton = this.templateService.getDoneButton();\n        this.customCounter = this.templateService.getCounter();\n    }\n    keyEvent(event) {\n        console.log(event);\n        if (event.keyCode === KEY_CODE.RIGHT_ARROW) {\n            if (this.isLastStep()) {\n                this.close();\n            }\n            else {\n                this.next();\n            }\n        }\n        else if (event.keyCode === KEY_CODE.LEFT_ARROW) {\n            this.prev();\n        }\n        else if (event.keyCode === KEY_CODE.ESCAPE_KEY) {\n            this.close();\n        }\n    }\n    prev() {\n        this.joyrideStepService.prev();\n    }\n    next() {\n        this.joyrideStepService.next();\n    }\n    close() {\n        this.joyrideStepService.close();\n    }\n    isFirstStep() {\n        return this.stepsContainerService.getStepNumber(this.step.name) === 1;\n    }\n    isLastStep() {\n        return (this.stepsContainerService.getStepNumber(this.step.name) ===\n            this.stepsContainerService.getStepsCount());\n    }\n    setStepStyle() {\n        switch (this.step.position) {\n            case 'top': {\n                this.setStyleTop();\n                break;\n            }\n            case 'bottom': {\n                this.setStyleBottom();\n                break;\n            }\n            case 'right': {\n                this.setStyleRight();\n                break;\n            }\n            case 'left': {\n                this.setStyleLeft();\n                break;\n            }\n            case 'center': {\n                this.setStyleCenter();\n                break;\n            }\n            default: {\n                this.setStyleBottom();\n            }\n        }\n    }\n    setStyleTop() {\n        this.stepsContainerService.updatePosition(this.step.name, 'top');\n        this.topPosition =\n            this.targetAbsoluteTop - DISTANCE_FROM_TARGET - this.stepHeight;\n        this.stepAbsoluteTop =\n            this.targetAbsoluteTop - DISTANCE_FROM_TARGET - this.stepHeight;\n        this.arrowTopPosition = this.stepHeight;\n        this.leftPosition =\n            this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n        this.stepAbsoluteLeft =\n            this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n        this.arrowLeftPosition = this.stepWidth / 2 - this.arrowSize;\n        this.adjustLeftPosition();\n        this.adjustRightPosition();\n        this.arrowPosition = 'bottom';\n        this.autofixTopPosition();\n    }\n    setStyleRight() {\n        this.stepsContainerService.updatePosition(this.step.name, 'right');\n        this.topPosition =\n            this.targetAbsoluteTop +\n                this.targetHeight / 2 -\n                this.stepHeight / 2;\n        this.stepAbsoluteTop =\n            this.targetAbsoluteTop +\n                this.targetHeight / 2 -\n                this.stepHeight / 2;\n        this.arrowTopPosition = this.stepHeight / 2 - this.arrowSize;\n        this.leftPosition =\n            this.targetAbsoluteLeft + this.targetWidth + DISTANCE_FROM_TARGET;\n        this.stepAbsoluteLeft =\n            this.targetAbsoluteLeft + this.targetWidth + DISTANCE_FROM_TARGET;\n        this.arrowLeftPosition = -this.arrowSize;\n        this.adjustTopPosition();\n        this.adjustBottomPosition();\n        this.arrowPosition = 'left';\n        this.autofixRightPosition();\n    }\n    setStyleBottom() {\n        this.stepsContainerService.updatePosition(this.step.name, 'bottom');\n        this.topPosition =\n            this.targetAbsoluteTop + this.targetHeight + DISTANCE_FROM_TARGET;\n        this.stepAbsoluteTop =\n            this.targetAbsoluteTop + this.targetHeight + DISTANCE_FROM_TARGET;\n        this.arrowTopPosition = -this.arrowSize;\n        this.arrowLeftPosition = this.stepWidth / 2 - this.arrowSize;\n        this.leftPosition =\n            this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n        this.stepAbsoluteLeft =\n            this.targetWidth / 2 - this.stepWidth / 2 + this.targetAbsoluteLeft;\n        this.adjustLeftPosition();\n        this.adjustRightPosition();\n        this.arrowPosition = 'top';\n        this.autofixBottomPosition();\n    }\n    setStyleLeft() {\n        this.stepsContainerService.updatePosition(this.step.name, 'left');\n        this.topPosition =\n            this.targetAbsoluteTop +\n                this.targetHeight / 2 -\n                this.stepHeight / 2;\n        this.stepAbsoluteTop =\n            this.targetAbsoluteTop +\n                this.targetHeight / 2 -\n                this.stepHeight / 2;\n        this.arrowTopPosition = this.stepHeight / 2 - this.arrowSize;\n        this.leftPosition =\n            this.targetAbsoluteLeft - this.stepWidth - DISTANCE_FROM_TARGET;\n        this.stepAbsoluteLeft =\n            this.targetAbsoluteLeft - this.stepWidth - DISTANCE_FROM_TARGET;\n        this.arrowLeftPosition = this.stepWidth;\n        this.adjustTopPosition();\n        this.adjustBottomPosition();\n        this.arrowPosition = 'right';\n        this.autofixLeftPosition();\n    }\n    setStyleCenter() {\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'position', 'fixed');\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'top', '50%');\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'left', '50%');\n        this.updateStepDimensions();\n        this.renderer.setStyle(this.stepHolder.nativeElement, 'transform', `translate(-${this.stepWidth / 2}px, -${this.stepHeight / 2}px)`);\n        this.showArrow = false;\n    }\n    adjustLeftPosition() {\n        if (this.leftPosition < 0) {\n            this.arrowLeftPosition =\n                this.arrowLeftPosition +\n                    this.leftPosition -\n                    DEFAULT_DISTANCE_FROM_MARGIN_LEFT;\n            this.leftPosition = DEFAULT_DISTANCE_FROM_MARGIN_LEFT;\n        }\n    }\n    adjustRightPosition() {\n        let currentWindowWidth = document.body.clientWidth;\n        if (this.stepAbsoluteLeft + this.stepWidth > currentWindowWidth) {\n            let newLeftPos = this.leftPosition -\n                (this.stepAbsoluteLeft +\n                    this.stepWidth +\n                    DEFAULT_DISTANCE_FROM_MARGIN_RIGHT -\n                    currentWindowWidth);\n            let deltaLeftPosition = newLeftPos - this.leftPosition;\n            this.leftPosition = newLeftPos;\n            this.arrowLeftPosition = this.arrowLeftPosition - deltaLeftPosition;\n        }\n    }\n    adjustTopPosition() {\n        if (this.stepAbsoluteTop < 0) {\n            this.arrowTopPosition =\n                this.arrowTopPosition +\n                    this.topPosition -\n                    DEFAULT_DISTANCE_FROM_MARGIN_TOP;\n            this.topPosition = DEFAULT_DISTANCE_FROM_MARGIN_TOP;\n        }\n    }\n    adjustBottomPosition() {\n        if (this.stepAbsoluteTop + this.stepHeight > this.documentHeight) {\n            let newTopPos = this.topPosition -\n                (this.stepAbsoluteTop +\n                    this.stepHeight +\n                    DEFAULT_DISTANCE_FROM_MARGIN_BOTTOM -\n                    this.documentHeight);\n            let deltaTopPosition = newTopPos - this.topPosition;\n            this.topPosition = newTopPos;\n            this.arrowTopPosition = this.arrowTopPosition - deltaTopPosition;\n        }\n    }\n    autofixTopPosition() {\n        if (this.positionAlreadyFixed) {\n            this.logger.warn('No step positions found for this step. The step will be centered.');\n        }\n        else if (this.targetAbsoluteTop - this.stepHeight - this.arrowSize <\n            0) {\n            this.positionAlreadyFixed = true;\n            this.setStyleRight();\n        }\n    }\n    autofixRightPosition() {\n        if (this.targetAbsoluteLeft +\n            this.targetWidth +\n            this.stepWidth +\n            this.arrowSize >\n            document.body.clientWidth) {\n            this.setStyleBottom();\n        }\n    }\n    autofixBottomPosition() {\n        if (this.targetAbsoluteTop +\n            this.stepHeight +\n            this.arrowSize +\n            this.targetHeight >\n            this.documentHeight) {\n            this.setStyleLeft();\n        }\n    }\n    autofixLeftPosition() {\n        if (this.targetAbsoluteLeft - this.stepWidth - this.arrowSize < 0) {\n            this.setStyleTop();\n        }\n    }\n    subscribeToResizeEvents() {\n        return this.eventListenerService.resizeEvent.subscribe(() => {\n            this.redrawStep();\n        });\n    }\n    redrawStep() {\n        this.updateStepDimensions();\n        this.drawStep();\n    }\n    getDimensionsByAspectRatio(width, height, aspectRatio) {\n        let calcHeight = (width + height) / (1 + aspectRatio);\n        let calcWidth = calcHeight * aspectRatio;\n        return {\n            width: calcWidth,\n            height: calcHeight\n        };\n    }\n    adjustDimensions(width, height) {\n        let area = width * height;\n        let newWidth = width;\n        let newHeight = height;\n        if (width > STEP_MAX_WIDTH) {\n            newWidth = STEP_MAX_WIDTH;\n            newHeight = area / newWidth;\n        }\n        else if (width < STEP_MIN_WIDTH) {\n            newWidth = STEP_MIN_WIDTH;\n            newHeight = STEP_MIN_WIDTH / ASPECT_RATIO;\n        }\n        return {\n            width: newWidth,\n            height: newHeight\n        };\n    }\n    updateStepDimensions() {\n        this.stepWidth = this.stepContainer.nativeElement.clientWidth;\n        this.stepHeight = this.stepContainer.nativeElement.clientHeight;\n    }\n    ngOnDestroy() {\n        this.subscriptions.forEach(subscription => {\n            subscription.unsubscribe();\n        });\n    }\n}\nJoyrideStepComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepComponent, deps: [{ token: i0.Injector }, { token: JoyrideStepsContainerService }, { token: EventListenerService }, { token: DocumentService }, { token: i0.Renderer2 }, { token: LoggerService }, { token: JoyrideOptionsService }, { token: TemplatesService }], target: i0.ɵɵFactoryTarget.Component });\nJoyrideStepComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"13.1.1\", type: JoyrideStepComponent, selector: \"joyride-step\", inputs: { step: \"step\" }, host: { listeners: { \"window:keyup\": \"keyEvent($event)\" } }, viewQueries: [{ propertyName: \"stepHolder\", first: true, predicate: [\"stepHolder\"], descendants: true, static: true }, { propertyName: \"stepContainer\", first: true, predicate: [\"stepContainer\"], descendants: true, static: true }], ngImport: i0, template: \"<div #stepHolder class=\\\"joyride-step__holder\\\" [id]=\\\"'joyride-step-' + step.name\\\" [style.top.px]=\\\"topPosition\\\" [style.left.px]=\\\"leftPosition\\\">\\n    <joyride-arrow *ngIf=\\\"showArrow\\\" class=\\\"joyride-step__arrow\\\" [position]=\\\"arrowPosition\\\" [style.top.px]=\\\"arrowTopPosition\\\"\\n        [style.left.px]=\\\"arrowLeftPosition\\\"></joyride-arrow>\\n    <div #stepContainer class=\\\"joyride-step__container\\\">\\n        <joy-close-button class=\\\"joyride-step__close\\\" (click)=\\\"close()\\\"></joy-close-button>\\n        <div class=\\\"joyride-step__header\\\">\\n            <div class=\\\"joyride-step__title\\\" [style.color]=\\\"themeColor\\\">{{ title | async }}</div>\\n        </div>\\n        <div class=\\\"joyride-step__body\\\">\\n            <ng-container *ngTemplateOutlet=\\\"customContent ? customContent : defaultContent; context: ctx\\\"></ng-container>\\n            <ng-template #defaultContent>\\n                {{ text | async }}\\n            </ng-template>\\n        </div>\\n        <div class=\\\"joyride-step__footer\\\">\\n            <div *ngIf=\\\"isCounterVisible\\\" class=\\\"joyride-step__counter-container\\\">\\n                <ng-container *ngTemplateOutlet=\\\"customCounter ? customCounter : defaultCounter; context: counterData\\\"></ng-container>\\n                <ng-template #defaultCounter>\\n                    <div class=\\\"joyride-step__counter\\\">{{ counter }}</div>\\n                </ng-template>\\n            </div>\\n            <div class=\\\"joyride-step__buttons-container\\\">\\n                <div class=\\\"joyride-step__prev-container joyride-step__button\\\" *ngIf=\\\"isPrevButtonVisible && !isFirstStep()\\\" (click)=\\\"prev()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customPrevButton ? customPrevButton : defaultPrevButton\\\"></ng-container>\\n                    <ng-template #defaultPrevButton>\\n                        <joyride-button class=\\\"joyride-step__prev-button\\\" [color]=\\\"themeColor\\\">{{ prevText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <div class=\\\"joyride-step__next-container joyride-step__button\\\" *ngIf=\\\"!isLastStep(); else doneButton\\\" (click)=\\\"next()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customNextButton ? customNextButton : defaulNextButton\\\"></ng-container>\\n                    <ng-template #defaulNextButton>\\n                        <joyride-button [color]=\\\"themeColor\\\">{{ nextText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <ng-template #doneButton>\\n                    <div class=\\\"joyride-step__done-container joyride-step__button\\\" (click)=\\\"close()\\\">\\n                        <ng-container *ngTemplateOutlet=\\\"customDoneButton ? customDoneButton : defaultDoneButton\\\"></ng-container>\\n                        <ng-template #defaultDoneButton>\\n                            <joyride-button class=\\\"joyride-step__done-button\\\" [color]=\\\"themeColor\\\">{{ doneText | async }}</joyride-button>\\n                        </ng-template>\\n                    </div>\\n                </ng-template>\\n            </div>\\n        </div>\\n    </div>\\n</div>\", styles: [\".joyride-step__holder{position:absolute;font-family:Arial,Helvetica,sans-serif;font-size:16px;z-index:1001}.joyride-step__arrow{position:absolute;left:40px;z-index:1002}.joyride-step__container{box-sizing:border-box;position:relative;color:#000;background-color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:10px;box-shadow:0 0 30px 1px #000}.joyride-step__header{display:flex;align-items:center;padding:8px}.joyride-step__title{font-weight:700;font-size:20px}.joyride-step__close{position:absolute;right:10px;top:10px;width:14px;height:14px;cursor:pointer}.joyride-step__body{text-align:left;padding:10px 8px}.joyride-step__footer{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px}.joyride-step__buttons-container{display:flex;flex-direction:row}.joyride-step__button:first-child{margin-right:2.5px}.joyride-step__button:last-child{margin-left:2.5px}.joyride-step__counter{font-weight:700;font-size:14px}.joyride-step__counter-container{margin-right:10px}\\n\"], components: [{ type: JoyrideArrowComponent, selector: \"joyride-arrow\", inputs: [\"position\"] }, { type: JoyrideCloseButtonComponent, selector: \"joy-close-button\" }, { type: JoyrideButtonComponent, selector: \"joyride-button\", inputs: [\"color\"], outputs: [\"clicked\"] }], directives: [{ type: i10.NgIf, selector: \"[ngIf]\", inputs: [\"ngIf\", \"ngIfThen\", \"ngIfElse\"] }, { type: i10.NgTemplateOutlet, selector: \"[ngTemplateOutlet]\", inputs: [\"ngTemplateOutletContext\", \"ngTemplateOutlet\"] }], pipes: { \"async\": i10.AsyncPipe }, encapsulation: i0.ViewEncapsulation.None });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepComponent, decorators: [{\n            type: Component,\n            args: [{ selector: 'joyride-step', encapsulation: ViewEncapsulation.None, template: \"<div #stepHolder class=\\\"joyride-step__holder\\\" [id]=\\\"'joyride-step-' + step.name\\\" [style.top.px]=\\\"topPosition\\\" [style.left.px]=\\\"leftPosition\\\">\\n    <joyride-arrow *ngIf=\\\"showArrow\\\" class=\\\"joyride-step__arrow\\\" [position]=\\\"arrowPosition\\\" [style.top.px]=\\\"arrowTopPosition\\\"\\n        [style.left.px]=\\\"arrowLeftPosition\\\"></joyride-arrow>\\n    <div #stepContainer class=\\\"joyride-step__container\\\">\\n        <joy-close-button class=\\\"joyride-step__close\\\" (click)=\\\"close()\\\"></joy-close-button>\\n        <div class=\\\"joyride-step__header\\\">\\n            <div class=\\\"joyride-step__title\\\" [style.color]=\\\"themeColor\\\">{{ title | async }}</div>\\n        </div>\\n        <div class=\\\"joyride-step__body\\\">\\n            <ng-container *ngTemplateOutlet=\\\"customContent ? customContent : defaultContent; context: ctx\\\"></ng-container>\\n            <ng-template #defaultContent>\\n                {{ text | async }}\\n            </ng-template>\\n        </div>\\n        <div class=\\\"joyride-step__footer\\\">\\n            <div *ngIf=\\\"isCounterVisible\\\" class=\\\"joyride-step__counter-container\\\">\\n                <ng-container *ngTemplateOutlet=\\\"customCounter ? customCounter : defaultCounter; context: counterData\\\"></ng-container>\\n                <ng-template #defaultCounter>\\n                    <div class=\\\"joyride-step__counter\\\">{{ counter }}</div>\\n                </ng-template>\\n            </div>\\n            <div class=\\\"joyride-step__buttons-container\\\">\\n                <div class=\\\"joyride-step__prev-container joyride-step__button\\\" *ngIf=\\\"isPrevButtonVisible && !isFirstStep()\\\" (click)=\\\"prev()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customPrevButton ? customPrevButton : defaultPrevButton\\\"></ng-container>\\n                    <ng-template #defaultPrevButton>\\n                        <joyride-button class=\\\"joyride-step__prev-button\\\" [color]=\\\"themeColor\\\">{{ prevText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <div class=\\\"joyride-step__next-container joyride-step__button\\\" *ngIf=\\\"!isLastStep(); else doneButton\\\" (click)=\\\"next()\\\">\\n                    <ng-container *ngTemplateOutlet=\\\"customNextButton ? customNextButton : defaulNextButton\\\"></ng-container>\\n                    <ng-template #defaulNextButton>\\n                        <joyride-button [color]=\\\"themeColor\\\">{{ nextText | async }}</joyride-button>\\n                    </ng-template>\\n                </div>\\n                <ng-template #doneButton>\\n                    <div class=\\\"joyride-step__done-container joyride-step__button\\\" (click)=\\\"close()\\\">\\n                        <ng-container *ngTemplateOutlet=\\\"customDoneButton ? customDoneButton : defaultDoneButton\\\"></ng-container>\\n                        <ng-template #defaultDoneButton>\\n                            <joyride-button class=\\\"joyride-step__done-button\\\" [color]=\\\"themeColor\\\">{{ doneText | async }}</joyride-button>\\n                        </ng-template>\\n                    </div>\\n                </ng-template>\\n            </div>\\n        </div>\\n    </div>\\n</div>\", styles: [\".joyride-step__holder{position:absolute;font-family:Arial,Helvetica,sans-serif;font-size:16px;z-index:1001}.joyride-step__arrow{position:absolute;left:40px;z-index:1002}.joyride-step__container{box-sizing:border-box;position:relative;color:#000;background-color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:10px;box-shadow:0 0 30px 1px #000}.joyride-step__header{display:flex;align-items:center;padding:8px}.joyride-step__title{font-weight:700;font-size:20px}.joyride-step__close{position:absolute;right:10px;top:10px;width:14px;height:14px;cursor:pointer}.joyride-step__body{text-align:left;padding:10px 8px}.joyride-step__footer{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px}.joyride-step__buttons-container{display:flex;flex-direction:row}.joyride-step__button:first-child{margin-right:2.5px}.joyride-step__button:last-child{margin-left:2.5px}.joyride-step__counter{font-weight:700;font-size:14px}.joyride-step__counter-container{margin-right:10px}\\n\"] }]\n        }], ctorParameters: function () { return [{ type: i0.Injector }, { type: JoyrideStepsContainerService }, { type: EventListenerService }, { type: DocumentService }, { type: i0.Renderer2 }, { type: LoggerService }, { type: JoyrideOptionsService }, { type: TemplatesService }]; }, propDecorators: { step: [{\n                type: Input\n            }], stepHolder: [{\n                type: ViewChild,\n                args: ['stepHolder', { static: true }]\n            }], stepContainer: [{\n                type: ViewChild,\n                args: ['stepContainer', { static: true }]\n            }], keyEvent: [{\n                type: HostListener,\n                args: ['window:keyup', ['$event']]\n            }] } });\n\nclass StepDrawerService {\n    constructor(componentFactoryResolver, appRef, injector) {\n        this.componentFactoryResolver = componentFactoryResolver;\n        this.appRef = appRef;\n        this.injector = injector;\n        this.refMap = {};\n    }\n    draw(step) {\n        // 1. Create a component reference from the component\n        const ref = this.componentFactoryResolver\n            .resolveComponentFactory(JoyrideStepComponent)\n            .create(this.injector);\n        // 2. Attach component to the appRef so that it's inside the ng component tree\n        this.appRef.attachView(ref.hostView);\n        // 3. Get DOM element from component\n        const domElem = ref.hostView\n            .rootNodes[0];\n        // 4. Append DOM element to the body\n        document.body.appendChild(domElem);\n        const instance = ref.instance;\n        instance.step = step;\n        ref.changeDetectorRef.detectChanges();\n        step.stepInstance = instance;\n        this.refMap[step.name] = ref;\n    }\n    remove(step) {\n        this.appRef.detachView(this.refMap[step.name].hostView);\n        this.refMap[step.name].destroy();\n    }\n}\nStepDrawerService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: StepDrawerService, deps: [{ token: i0.ComponentFactoryResolver }, { token: i0.ApplicationRef }, { token: i0.Injector }], target: i0.ɵɵFactoryTarget.Injectable });\nStepDrawerService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: StepDrawerService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: StepDrawerService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i0.ComponentFactoryResolver }, { type: i0.ApplicationRef }, { type: i0.Injector }]; } });\n\nconst SCROLLBAR_SIZE = 20;\nconst DISTANCE_FROM_TARGET = 15;\nconst ARROW_SIZE = 10;\nclass JoyrideStepService {\n    constructor(backDropService, eventListener, stepsContainerService, documentService, DOMService, stepDrawerService, optionsService, router, logger) {\n        this.backDropService = backDropService;\n        this.eventListener = eventListener;\n        this.stepsContainerService = stepsContainerService;\n        this.documentService = documentService;\n        this.DOMService = DOMService;\n        this.stepDrawerService = stepDrawerService;\n        this.optionsService = optionsService;\n        this.router = router;\n        this.logger = logger;\n        this.winTopPosition = 0;\n        this.winBottomPosition = 0;\n        this.stepsObserver = new ReplaySubject();\n        this.initViewportPositions();\n        this.subscribeToScrollEvents();\n        this.subscribeToResizeEvents();\n    }\n    initViewportPositions() {\n        this.winTopPosition = 0;\n        this.winBottomPosition = this.DOMService.getNativeWindow().innerHeight - SCROLLBAR_SIZE;\n    }\n    subscribeToScrollEvents() {\n        this.eventListener.startListeningScrollEvents();\n        this.eventListener.scrollEvent.subscribe(scroll => {\n            this.winTopPosition = scroll.scrollY;\n            this.winBottomPosition = this.winTopPosition + this.DOMService.getNativeWindow().innerHeight - SCROLLBAR_SIZE;\n            if (this.currentStep)\n                this.backDropService.redraw(this.currentStep, scroll);\n        });\n    }\n    subscribeToResizeEvents() {\n        this.eventListener.resizeEvent.subscribe(() => {\n            if (this.currentStep)\n                this.backDropService.redrawTarget(this.currentStep);\n        });\n    }\n    drawStep(step) {\n        step.position = step.position === NO_POSITION ? this.optionsService.getStepDefaultPosition() : step.position;\n        this.stepDrawerService.draw(step);\n    }\n    startTour() {\n        this.stepsObserver = new ReplaySubject();\n        this.stepsContainerService.init();\n        this.documentService.setDocumentHeight();\n        this.tryShowStep(StepActionType.NEXT);\n        this.eventListener.startListeningResizeEvents();\n        this.subscribeToStepsUpdates();\n        return this.stepsObserver.asObservable();\n    }\n    close() {\n        this.removeCurrentStep();\n        this.notifyTourIsFinished();\n        this.DOMService.getNativeWindow().scrollTo(0, 0);\n        this.eventListener.stopListeningResizeEvents();\n        this.backDropService.remove();\n    }\n    prev() {\n        this.removeCurrentStep();\n        this.currentStep.prevCliked.emit();\n        this.tryShowStep(StepActionType.PREV);\n    }\n    next() {\n        this.removeCurrentStep();\n        this.currentStep.nextClicked.emit();\n        this.tryShowStep(StepActionType.NEXT);\n    }\n    async navigateToStepPage(action) {\n        let stepRoute = this.stepsContainerService.getStepRoute(action);\n        if (stepRoute) {\n            return await this.router.navigate([stepRoute]);\n        }\n    }\n    subscribeToStepsUpdates() {\n        this.stepsContainerService.stepHasBeenModified.subscribe(updatedStep => {\n            if (this.currentStep && this.currentStep.name === updatedStep.name) {\n                this.currentStep = updatedStep;\n            }\n        });\n    }\n    async tryShowStep(actionType) {\n        await this.navigateToStepPage(actionType);\n        const timeout = this.optionsService.getWaitingTime();\n        if (timeout > 100)\n            this.backDropService.remove();\n        setTimeout(() => {\n            try {\n                this.showStep(actionType);\n            }\n            catch (error) {\n                if (error instanceof JoyrideStepDoesNotExist) {\n                    this.tryShowStep(actionType);\n                }\n                else if (error instanceof JoyrideStepOutOfRange) {\n                    this.logger.error('Forcing the tour closure: First or Last step not found in the DOM.');\n                    this.close();\n                }\n                else {\n                    throw new Error(error);\n                }\n            }\n        }, timeout);\n    }\n    showStep(actionType) {\n        this.currentStep = this.stepsContainerService.get(actionType);\n        if (this.currentStep == null)\n            throw new JoyrideStepDoesNotExist('');\n        this.notifyStepClicked(actionType);\n        // Scroll the element to get it visible if it's in a scrollable element\n        this.scrollIfElementBeyondOtherElements();\n        this.backDropService.draw(this.currentStep);\n        this.drawStep(this.currentStep);\n        this.scrollIfStepAndTargetAreNotVisible();\n    }\n    notifyStepClicked(actionType) {\n        let stepInfo = {\n            number: this.stepsContainerService.getStepNumber(this.currentStep.name),\n            name: this.currentStep.name,\n            route: this.currentStep.route,\n            actionType\n        };\n        this.stepsObserver.next(stepInfo);\n    }\n    notifyTourIsFinished() {\n        if (this.currentStep)\n            this.currentStep.tourDone.emit();\n        this.stepsObserver.complete();\n    }\n    removeCurrentStep() {\n        if (this.currentStep)\n            this.stepDrawerService.remove(this.currentStep);\n    }\n    scrollIfStepAndTargetAreNotVisible() {\n        this.scrollWhenTargetOrStepAreHiddenBottom();\n        this.scrollWhenTargetOrStepAreHiddenTop();\n    }\n    scrollWhenTargetOrStepAreHiddenBottom() {\n        let totalTargetBottom = this.getMaxTargetAndStepBottomPosition();\n        if (totalTargetBottom > this.winBottomPosition) {\n            this.DOMService.getNativeWindow().scrollBy(0, totalTargetBottom - this.winBottomPosition);\n        }\n    }\n    scrollWhenTargetOrStepAreHiddenTop() {\n        let totalTargetTop = this.getMaxTargetAndStepTopPosition();\n        if (totalTargetTop < this.winTopPosition) {\n            this.DOMService.getNativeWindow().scrollBy(0, totalTargetTop - this.winTopPosition);\n        }\n    }\n    getMaxTargetAndStepBottomPosition() {\n        let targetAbsoluteTop = this.documentService.getElementAbsoluteTop(this.currentStep.targetViewContainer.element);\n        if (this.currentStep.position === 'top') {\n            return targetAbsoluteTop + this.currentStep.stepInstance.targetHeight;\n        }\n        else if (this.currentStep.position === 'bottom') {\n            return (targetAbsoluteTop +\n                this.currentStep.stepInstance.targetHeight +\n                this.currentStep.stepInstance.stepHeight +\n                ARROW_SIZE +\n                DISTANCE_FROM_TARGET);\n        }\n        else if (this.currentStep.position === 'right' || this.currentStep.position === 'left') {\n            return Math.max(targetAbsoluteTop + this.currentStep.stepInstance.targetHeight, targetAbsoluteTop + this.currentStep.stepInstance.targetHeight / 2 + this.currentStep.stepInstance.stepHeight / 2);\n        }\n    }\n    getMaxTargetAndStepTopPosition() {\n        let targetAbsoluteTop = this.documentService.getElementAbsoluteTop(this.currentStep.targetViewContainer.element);\n        if (this.currentStep.position === 'top') {\n            return targetAbsoluteTop - (this.currentStep.stepInstance.stepHeight + ARROW_SIZE + DISTANCE_FROM_TARGET);\n        }\n        else if (this.currentStep.position === 'bottom') {\n            return targetAbsoluteTop;\n        }\n        else if (this.currentStep.position === 'right' || this.currentStep.position === 'left') {\n            return Math.min(targetAbsoluteTop, targetAbsoluteTop + this.currentStep.stepInstance.targetHeight / 2 - this.currentStep.stepInstance.stepHeight / 2);\n        }\n    }\n    scrollIfElementBeyondOtherElements() {\n        if (this.isElementBeyondOthers() === 2) {\n            this.documentService.scrollToTheTop(this.currentStep.targetViewContainer.element);\n        }\n        if (this.isElementBeyondOthers() === 2) {\n            this.documentService.scrollToTheBottom(this.currentStep.targetViewContainer.element);\n        }\n        if (this.isElementBeyondOthers() === 1 && this.documentService.isParentScrollable(this.currentStep.targetViewContainer.element)) {\n            this.documentService.scrollIntoView(this.currentStep.targetViewContainer.element, this.currentStep.isElementOrAncestorFixed);\n        }\n        if (this.isElementBeyondOthers() === 1 && this.documentService.isParentScrollable(this.currentStep.targetViewContainer.element)) {\n            this.currentStep.targetViewContainer.element.nativeElement.scrollIntoView();\n        }\n    }\n    isElementBeyondOthers() {\n        return this.documentService.isElementBeyondOthers(this.currentStep.targetViewContainer.element, this.currentStep.isElementOrAncestorFixed, 'backdrop');\n    }\n}\nJoyrideStepService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepService, deps: [{ token: JoyrideBackdropService }, { token: EventListenerService }, { token: JoyrideStepsContainerService }, { token: DocumentService }, { token: DomRefService }, { token: StepDrawerService }, { token: JoyrideOptionsService }, { token: i3.Router }, { token: LoggerService }], target: i0.ɵɵFactoryTarget.Injectable });\nJoyrideStepService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideStepService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: JoyrideBackdropService }, { type: EventListenerService }, { type: JoyrideStepsContainerService }, { type: DocumentService }, { type: DomRefService }, { type: StepDrawerService }, { type: JoyrideOptionsService }, { type: i3.Router }, { type: LoggerService }]; } });\n\nclass JoyrideService {\n    constructor(platformId, stepService, optionsService) {\n        this.platformId = platformId;\n        this.stepService = stepService;\n        this.optionsService = optionsService;\n        this.tourInProgress = false;\n    }\n    startTour(options) {\n        if (!isPlatformBrowser(this.platformId)) {\n            return of(new JoyrideStepInfo());\n        }\n        if (!this.tourInProgress) {\n            this.tourInProgress = true;\n            if (options) {\n                this.optionsService.setOptions(options);\n            }\n            this.tour$ = this.stepService.startTour().pipe(finalize(() => (this.tourInProgress = false)));\n            this.tour$.subscribe();\n        }\n        return this.tour$;\n    }\n    closeTour() {\n        if (this.isTourInProgress())\n            this.stepService.close();\n    }\n    isTourInProgress() {\n        return this.tourInProgress;\n    }\n}\nJoyrideService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideService, deps: [{ token: PLATFORM_ID }, { token: JoyrideStepService }, { token: JoyrideOptionsService }], target: i0.ɵɵFactoryTarget.Injectable });\nJoyrideService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: Object, decorators: [{\n                    type: Inject,\n                    args: [PLATFORM_ID]\n                }] }, { type: JoyrideStepService }, { type: JoyrideOptionsService }]; } });\n\nconst routerModuleForChild = RouterModule.forChild([]);\nclass JoyrideModule {\n    static forRoot() {\n        return {\n            ngModule: JoyrideModule,\n            providers: [\n                JoyrideService,\n                JoyrideStepService,\n                JoyrideStepsContainerService,\n                JoyrideBackdropService,\n                EventListenerService,\n                DocumentService,\n                JoyrideOptionsService,\n                StepDrawerService,\n                DomRefService,\n                LoggerService,\n                TemplatesService,\n            ],\n        };\n    }\n    static forChild() {\n        return {\n            ngModule: JoyrideModule,\n            providers: [],\n        };\n    }\n}\nJoyrideModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nJoyrideModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideModule, declarations: [JoyrideDirective,\n        JoyrideStepComponent,\n        JoyrideArrowComponent,\n        JoyrideButtonComponent,\n        JoyrideCloseButtonComponent], imports: [CommonModule, i3.RouterModule], exports: [JoyrideDirective] });\nJoyrideModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideModule, imports: [[CommonModule, routerModuleForChild]] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.1.1\", ngImport: i0, type: JoyrideModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CommonModule, routerModuleForChild],\n                    declarations: [\n                        JoyrideDirective,\n                        JoyrideStepComponent,\n                        JoyrideArrowComponent,\n                        JoyrideButtonComponent,\n                        JoyrideCloseButtonComponent,\n                    ],\n                    exports: [JoyrideDirective],\n                }]\n        }] });\n\n/*\n * Public API Surface of ngx-joyride\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { ARROW_SIZE, DEFAULT_DISTANCE_FROM_MARGIN_LEFT, DEFAULT_DISTANCE_FROM_MARGIN_TOP, DEFAULT_TEXTS, DEFAULT_THEME_COLOR, DEFAULT_TIMEOUT_BETWEEN_STEPS, DISTANCE_FROM_TARGET, DocumentService, DomRefService, EventListenerService, JoyrideArrowComponent, JoyrideBackdropService, JoyrideButtonComponent, JoyrideCloseButtonComponent, JoyrideDirective, JoyrideModule, JoyrideOptionsService, JoyrideService, JoyrideStepComponent, JoyrideStepService, JoyrideStepsContainerService, KEY_CODE, LoggerService, NO_POSITION, ObservableCustomTexts, STEP_DEFAULT_POSITION, Scroll, StepActionType, StepDrawerService, TemplatesService, routerModuleForChild };\n//# sourceMappingURL=ngx-joyride.mjs.map\n",null,null,null],"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,eAApB;AACA,SAASC,UAAT,EAAqBC,WAArB,EAAkCC,MAAlC,EAA0CC,YAA1C,EAAwDC,SAAxD,EAAmEC,KAAnE,EAA0EC,MAA1E,EAAkFC,SAAlF,EAA6FC,iBAA7F,EAAgHC,SAAhH,EAA2HC,YAA3H,EAAyIC,QAAzI,QAAyJ,eAAzJ;AACA,OAAO,KAAKC,GAAZ,MAAqB,iBAArB;AACA,SAASC,iBAAT,EAA4BC,YAA5B,QAAgD,iBAAhD;AACA,SAASC,aAAT,EAAwBC,EAAxB,EAA4BC,UAA5B,EAAwCC,OAAxC,QAAuD,MAAvD;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,SAASC,YAAT,QAA6B,iBAA7B;AACA,SAASC,QAAT,QAAyB,gBAAzB;;;;;;;;;;;;;;;;IAyIwGtB,EC/IpG,kC;;;;mBD+IoGA,E;IAAAA,EC/IZ,0F;ID+IYA,EC/IvC,6C;;;;;;ID+IuCA,ECvI5F,sB;;;;;;IDuI4FA,ECrIxF,U;IDqIwFA,E;;;;mBAAAA,E;IAAAA,ECrIxF,yBDqIwFA,ECrIxF,qC;;;;;;IDqIwFA,EChIxF,sB;;;;;;IDgIwFA,EC9HpF,6B;ID8HoFA,EC9HjD,U;ID8HiDA,EC9HpC,e;;;;oBD8HoCA,E;IAAAA,EC9HjD,a;ID8HiDA,EC9HjD,mC;;;;;;ID8HiDA,ECjI5F,6B;IDiI4FA,EChIxF,4F;IDgIwFA,EC/HxF,kGD+HwFA,EC/HxF,wB;ID+HwFA,EC5H5F,e;;;;iBD4H4FA,E;;mBAAAA,E;IAAAA,EChIzE,a;IDgIyEA,EChIzE,kI;;;;;;IDgIyEA,ECzHpF,sB;;;;;;IDyHoFA,ECvHhF,wC;IDuHgFA,ECvHT,U;IDuHSA,E;IAAAA,ECvHa,e;;;;oBDuHbA,E;IAAAA,ECvH9B,wC;IDuH8BA,ECvHT,a;IDuHSA,ECvHT,mBDuHSA,ECvHT,qC;;;;;;iBDuHSA,E;;IAAAA,EC1HxF,6B;ID0HwFA,EC1HqB;MD0HrBA,EC1HqB;MAAA,gBD0HrBA,EC1HqB;MAAA;IAAA,E;ID0HrBA,ECzHpF,6F;IDyHoFA,ECxHpF,kGDwHoFA,ECxHpF,wB;IDwHoFA,ECrHxF,e;;;;iBDqHwFA,E;;mBAAAA,E;IAAAA,ECzHrE,a;IDyHqEA,ECzHrE,yF;;;;;;IDyHqEA,ECnHpF,sB;;;;;;IDmHoFA,ECjHhF,wC;IDiHgFA,ECjH3C,U;IDiH2CA,E;IAAAA,ECjHrB,e;;;;oBDiHqBA,E;IAAAA,ECjHhE,wC;IDiHgEA,ECjH3C,a;IDiH2CA,ECjH3C,mBDiH2CA,ECjH3C,qC;;;;;;iBDiH2CA,E;;IAAAA,ECpHxF,6B;IDoHwFA,ECpHc;MDoHdA,ECpHc;MAAA,gBDoHdA,ECpHc;MAAA;IAAA,E;IDoHdA,ECnHpF,6F;IDmHoFA,EClHpF,kGDkHoFA,EClHpF,wB;IDkHoFA,EC/GxF,e;;;;iBD+GwFA,E;;mBAAAA,E;IAAAA,ECnHrE,a;IDmHqEA,ECnHrE,yF;;;;;;IDmHqEA,EC5GhF,sB;;;;;;ID4GgFA,EC1G5E,wC;ID0G4EA,EC1GL,U;ID0GKA,E;IAAAA,EC1GiB,e;;;;oBD0GjBA,E;IAAAA,EC1G1B,wC;ID0G0BA,EC1GL,a;ID0GKA,EC1GL,mBD0GKA,EC1GL,qC;;;;;;iBD0GKA,E;;IAAAA,EC7GpF,6B;ID6GoFA,EC7GrB;MD6GqBA,EC7GrB;MAAA,gBD6GqBA,EC7GrB;MAAA;IAAA,E;ID6GqBA,EC5GhF,qG;ID4GgFA,EC3GhF,0GD2GgFA,EC3GhF,wB;ID2GgFA,ECxGpF,e;;;;iBDwGoFA,E;;oBAAAA,E;IAAAA,EC5GjE,a;ID4GiEA,EC5GjE,2F;;;;AD3BvC,MAAMuB,WAAN,CAAkB;EACdC,WAAW,GAAG;IACV,KAAKC,KAAL,GAAa,IAAIT,aAAJ,EAAb;IACA,KAAKU,IAAL,GAAY,IAAIV,aAAJ,EAAZ;EACH;;AAJa;;AAOlB,MAAMW,YAAN,SAA2BC,KAA3B,CAAiC;EAC7BJ,WAAW,CAACK,OAAD,EAAU;IACjB,MAAMA,OAAN;IACAC,MAAM,CAACC,cAAP,CAAsB,IAAtB,EAA4BJ,YAAY,CAACK,SAAzC;EACH;;AAJ4B;;AAMjC,MAAMC,uBAAN,SAAsCL,KAAtC,CAA4C;EACxCJ,WAAW,CAACK,OAAD,EAAU;IACjB,MA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"},"metadata":{},"sourceType":"module"}